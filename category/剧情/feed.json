{
    "version": "https://jsonfeed.org/version/1",
    "title": "指尖小屋 • All posts by \"剧情\" category",
    "description": "学习的过程大概就是学了忘,忘了学，抽空多停下来总结，不要冲的太前。",
    "home_page_url": "https://www.fasty97.top",
    "items": [
        {
            "id": "https://www.fasty97.top/2020/04/28/Ink%E5%89%A7%E6%83%85%E7%BC%96%E6%8E%92/",
            "url": "https://www.fasty97.top/2020/04/28/Ink%E5%89%A7%E6%83%85%E7%BC%96%E6%8E%92/",
            "title": "Ink剧情编排",
            "date_published": "2020-04-28T13:54:55.000Z",
            "content_html": "<h3 id=\"快速食用\"><a class=\"markdownIt-Anchor\" href=\"#快速食用\">#</a> 快速食用</h3>\n<ol>\n<li>下载 inky 编辑器</li>\n<li>编写 ink 文件</li>\n<li>下载安装 unity 支持</li>\n<li>找到 ink 示例，将对应的 ink 生成的 json 导入运行游戏即可。</li>\n</ol>\n<h3 id=\"unity使用流程\"><a class=\"markdownIt-Anchor\" href=\"#unity使用流程\">#</a> unity 使用流程</h3>\n<p>在 unity 中，我们需要通过代码来驱动我们的剧情的进行。</p>\n<ol>\n<li>\n<p>首先我们需要 <code>创建至少2种Prefab</code> ，一种表示文字，一种表示按钮。</p>\n</li>\n<li>\n<p>然后我们需要创建一个 story 对象，载入对应的 json 文件<br>\n <code>story = new Story (inkJSONAsset.text);</code></p>\n</li>\n<li>\n<p>判断 story 能否继续，若能继续使用代码创建对应的游戏对象</p>\n</li>\n</ol>\n<figure class=\"highlight csharp\"><figcaption data-lang=\"C#\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>story<span class=\"token punctuation\">.</span>canContinue<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// Continue gets the next line of the story</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> text <span class=\"token operator\">=</span> story<span class=\"token punctuation\">.</span>Continue <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">// This removes any white space from the text.</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>text <span class=\"token operator\">=</span> text<span class=\"token punctuation\">.</span><span class=\"token function\">Trim</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// Display the text on screen!</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token function\">CreateContentView</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">// Display all the choices, if there are any!</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>story<span class=\"token punctuation\">.</span>currentChoices<span class=\"token punctuation\">.</span>Count <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">int</span></span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> story<span class=\"token punctuation\">.</span>currentChoices<span class=\"token punctuation\">.</span>Count<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t\t<span class=\"token class-name\">Choice</span> choice <span class=\"token operator\">=</span> story<span class=\"token punctuation\">.</span>currentChoices <span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\t\t<span class=\"token class-name\">Button</span> button <span class=\"token operator\">=</span> CreateChoiceView <span class=\"token punctuation\">(</span>choice<span class=\"token punctuation\">.</span>text<span class=\"token punctuation\">.</span>Trim <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t\t<span class=\"token comment\">// Tell the button what to do when we press it</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t\tbutton<span class=\"token punctuation\">.</span>onClick<span class=\"token punctuation\">.</span>AddListener <span class=\"token punctuation\">(</span><span class=\"token keyword\">delegate</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t\t\tOnClickChoiceButton <span class=\"token punctuation\">(</span>choice<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t\t<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token comment\">// If we've read all the content and there's no choices, the story is finished!</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token keyword\">else</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>\t<span class=\"token class-name\">Button</span> choice <span class=\"token operator\">=</span> <span class=\"token function\">CreateChoiceView</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"End of story.\\nRestart?\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>\tchoice<span class=\"token punctuation\">.</span>onClick<span class=\"token punctuation\">.</span><span class=\"token function\">AddListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">delegate</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>\t\t<span class=\"token function\">StartStory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><figure class=\"highlight csharp\"><figcaption data-lang=\"C#\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> CreateContentView <span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> text<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\t<span class=\"token class-name\">Text</span> storyText <span class=\"token operator\">=</span> Instantiate <span class=\"token punctuation\">(</span>textPrefab<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> <span class=\"token class-name\">Text</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\tstoryText<span class=\"token punctuation\">.</span>text <span class=\"token operator\">=</span> text<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>\tstoryText<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">.</span>SetParent <span class=\"token punctuation\">(</span>canvas<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// Creates a button showing the choice text</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token return-type class-name\">Button</span> CreateChoiceView <span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> text<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token comment\">// Creates the button from a prefab</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token class-name\">Button</span> choice <span class=\"token operator\">=</span> Instantiate <span class=\"token punctuation\">(</span>buttonPrefab<span class=\"token punctuation\">)</span> <span class=\"token keyword\">as</span> <span class=\"token class-name\">Button</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\tchoice<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">.</span>SetParent <span class=\"token punctuation\">(</span>canvas<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token comment\">// Gets the text from the button prefab</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t<span class=\"token class-name\">Text</span> choiceText <span class=\"token operator\">=</span> choice<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">GetComponentInChildren</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>Text<span class=\"token punctuation\">></span></span></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\tchoiceText<span class=\"token punctuation\">.</span>text <span class=\"token operator\">=</span> text<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token comment\">// Make the button expand to fit the text</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\t<span class=\"token class-name\">HorizontalLayoutGroup</span> layoutGroup <span class=\"token operator\">=</span> choice<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">GetComponent</span> <span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>HorizontalLayoutGroup<span class=\"token punctuation\">></span></span></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\tlayoutGroup<span class=\"token punctuation\">.</span>childForceExpandHeight <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\t<span class=\"token keyword\">return</span> choice<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><ol start=\"4\">\n<li>要记得每次显示时清除上一次的显示结果</li>\n</ol>\n<h2 id=\"书写规则\"><a class=\"markdownIt-Anchor\" href=\"#书写规则\">#</a> 书写规则</h2>\n<blockquote>\n<p>ink 有一套自己的书写格式，不符合规范时无法编译。</p>\n</blockquote>\n<ul>\n<li>选项 + xx 在选择后会重复 选项</li>\n<li>选项 + [xx] 在选择后不会重复 选项</li>\n<li>…</li>\n</ul>\n<h2 id=\"unity支持\"><a class=\"markdownIt-Anchor\" href=\"#unity支持\">#</a> Unity 支持</h2>\n<p>更新时间：2022 年 12 月 8 日 16:39:09</p>\n<blockquote>\n<p>INk 提供了 Unity 插件来支持。我们可以在 github 或者是 AssterStore 中获取。</p>\n</blockquote>\n<p>在 Unity 导入 <code>.ink</code>  文件可以在右侧检视图看到如下界面：</p>\n<p>在这个界面可以对整个故事流程进行概览。</p>\n<p>同时每次修改 <code>.ink</code>  文件后，都会自动生成一个 <code>json</code>  文件。我们要使用的就是生成的 Json 文件。</p>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202212151532228.png\" alt=\"image-20221215153223990\"></p>\n<h3 id=\"常用功能\"><a class=\"markdownIt-Anchor\" href=\"#常用功能\">#</a> 常用功能</h3>\n<figure class=\"highlight csharp\"><figcaption data-lang=\"C#\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 设置变量</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Ink<span class=\"token punctuation\">.</span>variablesState<span class=\"token punctuation\">[</span><span class=\"token string\">\"hp\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token number\">300</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">// 游戏端函数</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>Ink<span class=\"token punctuation\">.</span><span class=\"token function\">BindExternalFunction</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"log\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> info<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">&#123;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">Log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"日志：\"</span> <span class=\"token operator\">+</span> info<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">// 保存</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> savedJson <span class=\"token operator\">=</span> _inkStory<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span><span class=\"token function\">ToJson</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">// 读取</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>_inkStory<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span><span class=\"token function\">LoadJson</span><span class=\"token punctuation\">(</span>savedJson<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">// 从节点获取元数据</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token class-name\"><span class=\"token keyword\">var</span></span> tags<span class=\"token operator\">=</span> x<span class=\"token punctuation\">.</span><span class=\"token function\">TagsForContentAtPath</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"DATA\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>tags<span class=\"token punctuation\">.</span><span class=\"token function\">ForEach</span><span class=\"token punctuation\">(</span>s<span class=\"token operator\">=></span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">Log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Tag|\"</span><span class=\"token operator\">+</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><blockquote>\n<p>2023 年 6 月 14 日 09:58:30 更新</p>\n</blockquote>\n<h3 id=\"text-animator-for-unity\"><a class=\"markdownIt-Anchor\" href=\"#text-animator-for-unity\">#</a> Text Animator for Unity</h3>\n<blockquote>\n<p>这里推荐一个插件用于字符动画的播放 <code>Text Animator for Unity</code></p>\n</blockquote>\n<p>只需在 Text 上挂上相关组件即可以使用来实现文字的动画效果。</p>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202306140946043.png\" alt=\"Text Animator\"></p>\n<p>同时插件提供了很多内置的效果：</p>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202306140949470.png\" alt=\"image-20230614094916425\"></p>\n<p>使用 ink 和 textAnimator 配合实现的对话效果预览：</p>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202306140956218.gif\" alt=\"效果预览\"></p>\n<center>效果预览</center>\n<h3 id=\"相关链接\"><a class=\"markdownIt-Anchor\" href=\"#相关链接\">#</a> 相关链接</h3>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuaW5rbGVzdHVkaW9zLmNvbS9pbmsv\">inkle 官网</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2lua2xlL2lua3kvcmVsZWFzZXMvdGFnLzAuMTEuMA==\">inky 编辑器</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbmRpZW5vdmEuY29tL3UvYmxpbmR2b2xmL2Jsb2dyZWFkLzIzMjQ5\">相关教程参考 - 基础</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9pbmRpZW5vdmEuY29tL3UvYmxpbmR2b2xmL2Jsb2dyZWFkLzIzMjU3\">相关教程参考 - 高级</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9naXRodWIuY29tL2lua2xlL2luay9ibG9iL21hc3Rlci9Eb2N1bWVudGF0aW9uL1J1bm5pbmdZb3VySW5rLm1k\">ink/RunningYourInk.md at master · inkle/ink (github.com)</span></li>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNTAwNjExL2FydGljbGUvZGV0YWlscy8xMDkwMzM0MTQ=\">Ink 脚本语言学习笔记（一）_嘉神川优衣的博客 - CSDN 博客_unity ink 使用</span></li>\n</ul>\n",
            "tags": [
                "好物推荐"
            ]
        }
    ]
}