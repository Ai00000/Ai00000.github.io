{
    "version": "https://jsonfeed.org/version/1",
    "title": "指尖小屋 • All posts by \"热更新\" tag",
    "description": "学习的过程大概就是学了忘,忘了学，抽空多停下来总结，不要冲的太前。",
    "home_page_url": "https://www.fasty97.top",
    "items": [
        {
            "id": "https://www.fasty97.top/2023/07/14/HyBridCLR/",
            "url": "https://www.fasty97.top/2023/07/14/HyBridCLR/",
            "title": "HyBridCLR 初体验",
            "date_published": "2023-07-14T02:36:30.000Z",
            "content_html": "<table>\n<thead>\n<tr>\n<th>版本号</th>\n<th>创建 / 更新时间</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>V1.0</td>\n<td>2023-07-14 10:36:30</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202307141042564.png\" alt=\"image-20230714104235475\"></p>\n",
            "tags": [
                "热更新",
                "代码",
                "框架"
            ]
        },
        {
            "id": "https://www.fasty97.top/2023/07/13/YooAssets%E5%88%9D%E4%BD%93%E9%AA%8C/",
            "url": "https://www.fasty97.top/2023/07/13/YooAssets%E5%88%9D%E4%BD%93%E9%AA%8C/",
            "title": "YooAssets初体验",
            "date_published": "2023-07-13T01:10:43.000Z",
            "content_html": "<table>\n<thead>\n<tr>\n<th>版本号</th>\n<th>创建 / 更新时间</th>\n<th>操作</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>V1.0</td>\n<td>2023-07-13 09:10:43</td>\n<td>创建</td>\n</tr>\n<tr>\n<td>V1.1</td>\n<td>2023-07-19 09:33:17</td>\n<td>添加着色器变体说明</td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p><code>YooAssets</code>  是一个资源管理工具，基于 ab 包实现。</p>\n<p>通过 <code>YooAssets</code>  可以方便的对资源进行管理、分析、更新。</p>\n</blockquote>\n<h2 id=\"快速食用\"><a class=\"markdownIt-Anchor\" href=\"#快速食用\">#</a> 快速食用</h2>\n<p>打开管理界面 <strong>Edit/Project Settings/Package Manager</strong></p>\n<figure class=\"highlight csharp\"><figcaption data-lang=\"C#\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 输入以下内容（中国版）</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Name<span class=\"token punctuation\">:</span> <span class=\"token class-name\">package<span class=\"token punctuation\">.</span>openupm<span class=\"token punctuation\">.</span>cn</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>URL<span class=\"token punctuation\">:</span> https<span class=\"token punctuation\">:</span><span class=\"token operator\">/</span><span class=\"token operator\">/</span><span class=\"token return-type class-name\">package<span class=\"token punctuation\">.</span>openupm<span class=\"token punctuation\">.</span>cn</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">Scope</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> com<span class=\"token punctuation\">.</span>tuyoogame<span class=\"token punctuation\">.</span>yooasset</pre></td></tr></table></figure><p>在包管理器中安装 YooAssets</p>\n<h3 id=\"划分组别\"><a class=\"markdownIt-Anchor\" href=\"#划分组别\">#</a> 划分组别</h3>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202307140936034.png\" alt=\"image-20230714093639774\"></p>\n<h3 id=\"构建工具\"><a class=\"markdownIt-Anchor\" href=\"#构建工具\">#</a> 构建工具</h3>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202307140940872.png\" alt=\"image-20230714093947222\"></p>\n<h3 id=\"报告工具\"><a class=\"markdownIt-Anchor\" href=\"#报告工具\">#</a> 报告工具</h3>\n<p>在打包后可以使用报告工具查看相关数据：</p>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202307140941088.png\" alt=\"image-20230714094110038\"></p>\n<h2 id=\"调试工具\"><a class=\"markdownIt-Anchor\" href=\"#调试工具\">#</a> 调试工具</h2>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202307140943294.png\" alt=\"image-20230714094332240\"></p>\n<h2 id=\"模式\"><a class=\"markdownIt-Anchor\" href=\"#模式\">#</a> 模式</h2>\n<table>\n<thead>\n<tr>\n<th>模式</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>编辑器模式 EditorSimulateMode</td>\n<td>无需构建，直接使用</td>\n</tr>\n<tr>\n<td>离线模式 OfflinePlayMode</td>\n<td>单机游戏使用</td>\n</tr>\n<tr>\n<td>在线模式 HostPlayMode</td>\n<td>在线游戏热更新</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"代码范例\"><a class=\"markdownIt-Anchor\" href=\"#代码范例\">#</a> 代码范例</h2>\n<h3 id=\"封装资源加载\"><a class=\"markdownIt-Anchor\" href=\"#封装资源加载\">#</a> 封装资源加载</h3>\n<blockquote>\n<p>我们可以对通用资源加载进行封装，使用 1 行代码实现资源加载。</p>\n</blockquote>\n<figure class=\"highlight csharp\"><figcaption data-lang=\"C#\"><span>封装资源加载</span></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">private</span> <span class=\"token keyword\">async</span> <span class=\"token return-type class-name\">Task<span class=\"token punctuation\">&lt;</span>T<span class=\"token punctuation\">></span></span> <span class=\"token generic-method\"><span class=\"token function\">LoadAsync</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>T<span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> key<span class=\"token punctuation\">)</span> <span class=\"token keyword\">where</span> <span class=\"token class-name\">T</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token keyword\">class</span></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        key <span class=\"token operator\">=</span> key<span class=\"token punctuation\">.</span><span class=\"token function\">Replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"_\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>_package<span class=\"token punctuation\">.</span><span class=\"token function\">CheckLocationValid</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> handle <span class=\"token operator\">=</span> _package<span class=\"token punctuation\">.</span><span class=\"token function\">LoadAssetAsync</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> <span class=\"token keyword\">typeof</span><span class=\"token punctuation\">(</span><span class=\"token type-expression class-name\">T</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>            <span class=\"token keyword\">await</span> handle<span class=\"token punctuation\">.</span>Task<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            <span class=\"token keyword\">return</span> handle<span class=\"token punctuation\">.</span>AssetObject <span class=\"token keyword\">as</span> <span class=\"token class-name\">T</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>            Debug<span class=\"token punctuation\">.</span><span class=\"token function\">LogError</span><span class=\"token punctuation\">(</span><span class=\"token interpolation-string\"><span class=\"token string\">$\"</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token expression language-csharp\">key</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\"> 資源尋址地址錯誤！\"</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>            <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"通用示例\"><a class=\"markdownIt-Anchor\" href=\"#通用示例\">#</a> 通用示例</h3>\n<figure class=\"highlight csharp\"><figcaption data-lang=\"C#\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token keyword\">using</span> <span class=\"token namespace\">System</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Collections</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Collections<span class=\"token punctuation\">.</span>Generic</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token keyword\">using</span> <span class=\"token namespace\">System<span class=\"token punctuation\">.</span>Threading<span class=\"token punctuation\">.</span>Tasks</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token keyword\">using</span> <span class=\"token namespace\">Scenes<span class=\"token punctuation\">.</span>YooTest</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token keyword\">using</span> <span class=\"token namespace\">Sirenix<span class=\"token punctuation\">.</span>OdinInspector</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token keyword\">using</span> <span class=\"token namespace\">UnityEngine</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token keyword\">using</span> <span class=\"token namespace\">UnityEngine<span class=\"token punctuation\">.</span>SceneManagement</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">using</span> <span class=\"token namespace\">YooAsset</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">YooAssetTest</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token class-name\">MonoBehaviour</span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token class-name\">ResourcePackage</span> _package<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">const</span> <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> PackName <span class=\"token operator\">=</span> <span class=\"token string\">\"DefaultPackage\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">SerializeField</span></span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">private</span> <span class=\"token class-name\">EPlayMode</span> playMode<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">async</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">Start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        YooAssets<span class=\"token punctuation\">.</span><span class=\"token function\">Initialize</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        _package <span class=\"token operator\">=</span> YooAssets<span class=\"token punctuation\">.</span><span class=\"token function\">CreatePackage</span><span class=\"token punctuation\">(</span>PackName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>        YooAssets<span class=\"token punctuation\">.</span><span class=\"token function\">SetDefaultPackage</span><span class=\"token punctuation\">(</span>_package<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token class-name\">InitializationOperation</span> hand<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>playMode<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            <span class=\"token keyword\">case</span> EPlayMode<span class=\"token punctuation\">.</span>EditorSimulateMode<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>                <span class=\"token comment\">// 編輯器模式</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>                <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> sm <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">EditorSimulateModeParameters</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>                <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                    SimulateManifestFilePath <span class=\"token operator\">=</span> EditorSimulateModeHelper<span class=\"token punctuation\">.</span><span class=\"token function\">SimulateBuild</span><span class=\"token punctuation\">(</span>PackName<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>                hand <span class=\"token operator\">=</span> _package<span class=\"token punctuation\">.</span><span class=\"token function\">InitializeAsync</span><span class=\"token punctuation\">(</span>sm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>                <span class=\"token keyword\">await</span> hand<span class=\"token punctuation\">.</span>Task<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>            <span class=\"token keyword\">case</span> EPlayMode<span class=\"token punctuation\">.</span>OfflinePlayMode<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>                <span class=\"token comment\">// 離線模式</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>                hand <span class=\"token operator\">=</span> _package<span class=\"token punctuation\">.</span><span class=\"token function\">InitializeAsync</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">OfflinePlayModeParameters</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>                <span class=\"token keyword\">await</span> hand<span class=\"token punctuation\">.</span>Task<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>            <span class=\"token keyword\">case</span> EPlayMode<span class=\"token punctuation\">.</span>HostPlayMode<span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>                <span class=\"token comment\">// 在線模式</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>                <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> hs <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">HostPlayModeParameters</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>                    <span class=\"token punctuation\">&#123;</span> QueryServices <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">YooHostQuery</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> RemoteServices <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">YooRemote</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>                hand <span class=\"token operator\">=</span> _package<span class=\"token punctuation\">.</span><span class=\"token function\">InitializeAsync</span><span class=\"token punctuation\">(</span>hs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>                <span class=\"token keyword\">await</span> hand<span class=\"token punctuation\">.</span>Task<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>hand<span class=\"token punctuation\">.</span>Status <span class=\"token operator\">==</span> EOperationStatus<span class=\"token punctuation\">.</span>Succeed<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>                <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>                    Debug<span class=\"token punctuation\">.</span><span class=\"token function\">Log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"资源包初始化成功！当前资源版本:\"</span><span class=\"token operator\">+</span> _package<span class=\"token punctuation\">.</span><span class=\"token function\">GetPackageVersion</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>                <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>                <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>                    Debug<span class=\"token punctuation\">.</span><span class=\"token function\">LogError</span><span class=\"token punctuation\">(</span><span class=\"token interpolation-string\"><span class=\"token string\">$\"资源包初始化失败：</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token expression language-csharp\">hand<span class=\"token punctuation\">.</span>Error</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>                <span class=\"token function\">StartCoroutine</span><span class=\"token punctuation\">(</span><span class=\"token function\">HostLink</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>                <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"62\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\">IEnumerator</span> <span class=\"token function\">HostLink</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>        <span class=\"token comment\">// 檢查版本</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> upHandle <span class=\"token operator\">=</span> _package<span class=\"token punctuation\">.</span><span class=\"token function\">UpdatePackageVersionAsync</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 關閉時間戳</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>        <span class=\"token keyword\">yield</span> <span class=\"token keyword\">return</span> upHandle<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>upHandle<span class=\"token punctuation\">.</span>Status <span class=\"token operator\">==</span> EOperationStatus<span class=\"token punctuation\">.</span>Succeed<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>            <span class=\"token comment\">// 更新成功</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>            <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> packageVersion <span class=\"token operator\">=</span> upHandle<span class=\"token punctuation\">.</span>PackageVersion<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>            Debug<span class=\"token punctuation\">.</span><span class=\"token function\">Log</span><span class=\"token punctuation\">(</span><span class=\"token interpolation-string\"><span class=\"token string\">$\"已获取到最新版本号 : </span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token expression language-csharp\">packageVersion</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>            HotConfig<span class=\"token punctuation\">.</span>NewVision <span class=\"token operator\">=</span> packageVersion<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre>        <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>            <span class=\"token comment\">// 更新失败</span></pre></td></tr><tr><td data-num=\"77\"></td><td><pre>            Debug<span class=\"token punctuation\">.</span><span class=\"token function\">LogError</span><span class=\"token punctuation\">(</span>upHandle<span class=\"token punctuation\">.</span>Error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>        <span class=\"token comment\">// 更新資源</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre>        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> upAssetHandle <span class=\"token operator\">=</span> _package<span class=\"token punctuation\">.</span><span class=\"token function\">UpdatePackageManifestAsync</span><span class=\"token punctuation\">(</span>upHandle<span class=\"token punctuation\">.</span>PackageVersion<span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>        <span class=\"token keyword\">yield</span> <span class=\"token keyword\">return</span> upAssetHandle<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>upAssetHandle<span class=\"token punctuation\">.</span>Status <span class=\"token operator\">==</span> EOperationStatus<span class=\"token punctuation\">.</span>Succeed<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre>            Debug<span class=\"token punctuation\">.</span><span class=\"token function\">Log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"更新完成！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>            <span class=\"token function\">StartCoroutine</span><span class=\"token punctuation\">(</span><span class=\"token function\">Download</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre>        <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre>            Debug<span class=\"token punctuation\">.</span><span class=\"token function\">Log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"更新失敗：\"</span> <span class=\"token operator\">+</span> upAssetHandle<span class=\"token punctuation\">.</span>Error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"95\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"96\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token return-type class-name\">IEnumerator</span> <span class=\"token function\">Download</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>        <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> downloadingMaxNum <span class=\"token operator\">=</span> <span class=\"token number\">10</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"99\"></td><td><pre>        <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> failedTryAgain <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre>        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> package <span class=\"token operator\">=</span> _package<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> downloader <span class=\"token operator\">=</span> package<span class=\"token punctuation\">.</span><span class=\"token function\">CreateResourceDownloader</span><span class=\"token punctuation\">(</span>downloadingMaxNum<span class=\"token punctuation\">,</span> failedTryAgain<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"103\"></td><td><pre>        <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"需要下载的资源数量：\"</span><span class=\"token operator\">+</span>downloader<span class=\"token punctuation\">.</span>TotalDownloadCount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre>        <span class=\"token comment\">// 没有需要下载的资源</span></pre></td></tr><tr><td data-num=\"105\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>downloader<span class=\"token punctuation\">.</span>TotalDownloadCount <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"106\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span>  </pre></td></tr><tr><td data-num=\"107\"></td><td><pre>            <span class=\"token keyword\">yield</span> <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"108\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"109\"></td><td><pre></pre></td></tr><tr><td data-num=\"110\"></td><td><pre>        <span class=\"token comment\">// 需要下载的文件总数和总大小</span></pre></td></tr><tr><td data-num=\"111\"></td><td><pre>        <span class=\"token class-name\"><span class=\"token keyword\">int</span></span> totalDownloadCount <span class=\"token operator\">=</span> downloader<span class=\"token punctuation\">.</span>TotalDownloadCount<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"112\"></td><td><pre>        <span class=\"token class-name\"><span class=\"token keyword\">long</span></span> totalDownloadBytes <span class=\"token operator\">=</span> downloader<span class=\"token punctuation\">.</span>TotalDownloadBytes<span class=\"token punctuation\">;</span>    </pre></td></tr><tr><td data-num=\"113\"></td><td><pre></pre></td></tr><tr><td data-num=\"114\"></td><td><pre>        <span class=\"token comment\">// 注册回调方法</span></pre></td></tr><tr><td data-num=\"115\"></td><td><pre>        downloader<span class=\"token punctuation\">.</span>OnDownloadErrorCallback <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">)</span><span class=\"token operator\">=></span><span class=\"token punctuation\">&#123;</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"下载资源出错！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"116\"></td><td><pre>        downloader<span class=\"token punctuation\">.</span>OnDownloadProgressCallback <span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">,</span>c<span class=\"token punctuation\">,</span>b<span class=\"token punctuation\">)</span><span class=\"token operator\">=></span><span class=\"token punctuation\">&#123;</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token interpolation-string\"><span class=\"token string\">$\"当前下载进度：</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token expression language-csharp\">a</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">/</span><span class=\"token interpolation\"><span class=\"token punctuation\">&#123;</span><span class=\"token expression language-csharp\">x</span><span class=\"token punctuation\">&#125;</span></span><span class=\"token string\">\"</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"117\"></td><td><pre>        downloader<span class=\"token punctuation\">.</span>OnDownloadOverCallback <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token operator\">=></span><span class=\"token punctuation\">&#123;</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"下载完成\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"118\"></td><td><pre>        downloader<span class=\"token punctuation\">.</span>OnStartDownloadFileCallback <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>a<span class=\"token punctuation\">)</span><span class=\"token operator\">=></span><span class=\"token punctuation\">&#123;</span><span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"开始下载\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"119\"></td><td><pre></pre></td></tr><tr><td data-num=\"120\"></td><td><pre>        <span class=\"token comment\">// 开启下载</span></pre></td></tr><tr><td data-num=\"121\"></td><td><pre>        downloader<span class=\"token punctuation\">.</span><span class=\"token function\">BeginDownload</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"122\"></td><td><pre>        <span class=\"token keyword\">yield</span> <span class=\"token keyword\">return</span> downloader<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"123\"></td><td><pre></pre></td></tr><tr><td data-num=\"124\"></td><td><pre>        <span class=\"token comment\">// 检测下载结果</span></pre></td></tr><tr><td data-num=\"125\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>downloader<span class=\"token punctuation\">.</span>Status <span class=\"token operator\">==</span> EOperationStatus<span class=\"token punctuation\">.</span>Succeed<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"126\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"127\"></td><td><pre>            <span class=\"token comment\">// 下载成功</span></pre></td></tr><tr><td data-num=\"128\"></td><td><pre>            <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"下载成功！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"129\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"130\"></td><td><pre>        <span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"131\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"132\"></td><td><pre>            <span class=\"token comment\">// 下载失败</span></pre></td></tr><tr><td data-num=\"133\"></td><td><pre>            <span class=\"token function\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"下载失败：\"</span><span class=\"token operator\">+</span>downloader<span class=\"token punctuation\">.</span>Error<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"134\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"135\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"136\"></td><td><pre></pre></td></tr><tr><td data-num=\"137\"></td><td><pre>    <span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">Button</span></span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"138\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">async</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">CreateUI</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"139\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"140\"></td><td><pre>        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> root <span class=\"token operator\">=</span> GameObject<span class=\"token punctuation\">.</span><span class=\"token function\">Find</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Canvas\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"141\"></td><td><pre>        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> go <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token generic-method\"><span class=\"token function\">LoadAsync</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>GameObject<span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"UI/Image\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"142\"></td><td><pre>        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>go<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"143\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"144\"></td><td><pre>            <span class=\"token function\">Instantiate</span><span class=\"token punctuation\">(</span>go<span class=\"token punctuation\">,</span> root<span class=\"token punctuation\">.</span>transform<span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"145\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"146\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"147\"></td><td><pre></pre></td></tr><tr><td data-num=\"148\"></td><td><pre>    <span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">Button</span></span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"149\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">async</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">CreateCube</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"150\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"151\"></td><td><pre>        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> g<span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token generic-method\"><span class=\"token function\">LoadAsync</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>GameObject<span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"UI/Cube\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"152\"></td><td><pre>        <span class=\"token function\">Instantiate</span><span class=\"token punctuation\">(</span>g<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"153\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"154\"></td><td><pre></pre></td></tr><tr><td data-num=\"155\"></td><td><pre>    <span class=\"token punctuation\">[</span><span class=\"token attribute\"><span class=\"token class-name\">Button</span></span><span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"156\"></td><td><pre>    <span class=\"token keyword\">private</span> <span class=\"token keyword\">async</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">LoadScene</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"157\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"158\"></td><td><pre>        <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> sc <span class=\"token operator\">=</span> _package<span class=\"token punctuation\">.</span><span class=\"token function\">LoadSceneAsync</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Scene_1\"</span><span class=\"token punctuation\">,</span> LoadSceneMode<span class=\"token punctuation\">.</span>Additive<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"159\"></td><td><pre>        <span class=\"token keyword\">await</span> sc<span class=\"token punctuation\">.</span>Task<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"160\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"161\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"着色器变体收集\"><a class=\"markdownIt-Anchor\" href=\"#着色器变体收集\">#</a> 着色器变体收集</h2>\n<h3 id=\"什么是着色器变体\"><a class=\"markdownIt-Anchor\" href=\"#什么是着色器变体\">#</a> 什么是着色器变体</h3>\n<blockquote>\n<p>当我们写完一个 shader 以后，unity 需要加载和编译，这个过程由着色器的构建管线来完成，它的输入是着色器，而它的输出就是今天的主角 — 着色器变体；每一个着色器进入构建管线后会被解析，然后提取着色器片段（顶点着色器和片元着色器等），收集预处理指令，然后每一个着色器变体会有一个参数表；<br>\n————————————————<br>\n 版权声明：本文为 CSDN 博主「莫之」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。<br>\n原文链接：<span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM2MzgzNjIzL2FydGljbGUvZGV0YWlscy8xMDMzMjczODk=\">https://blog.csdn.net/qq_36383623/article/details/103327389</span></p>\n</blockquote>\n<h3 id=\"yooasset-收集着色器变体\"><a class=\"markdownIt-Anchor\" href=\"#yooasset-收集着色器变体\">#</a> YooAsset 收集着色器变体</h3>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202307190950490.png\" alt=\"image-20230719095020282\"></p>\n<blockquote>\n<p>收集的着色器变体文件需要打包进 AB 中，在 AB 中加载。</p>\n</blockquote>\n<h2 id=\"配合unitycdn使用\"><a class=\"markdownIt-Anchor\" href=\"#配合unitycdn使用\">#</a> 配合 UnityCDN 使用</h2>\n<blockquote>\n<p>PS：YooAsset 通过获取版本号，再更新对应版本资源。</p>\n<p>故可以将获取补丁文件的路径设置为动态的，通过获取到的版本号来获取对应资源，有利于资源在 CDN 的存储结构。</p>\n</blockquote>\n<ol>\n<li>创建一个 Bucket 存储池：</li>\n</ol>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202307140956218.png\" alt=\"image-20230714095638150\"></p>\n<ol start=\"2\">\n<li>下载相关 Unity 插件</li>\n</ol>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202307140958953.png\" alt=\"image-20230714095811900\"></p>\n<ol start=\"3\">\n<li>填写好相关 key</li>\n</ol>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202307140959349.png\" alt=\"\"></p>\n<ol start=\"4\">\n<li>上传相关文件</li>\n</ol>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202307141001266.png\" alt=\"image-20230714100120217\"></p>\n<h2 id=\"相关链接\"><a class=\"markdownIt-Anchor\" href=\"#相关链接\">#</a> 相关链接</h2>\n<ul>\n<li><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cueW9vYXNzZXQuY29tLw==\">Hello from YooAsset | YooAsset</span></li>\n<li>+<span class=\"exturl\" data-url=\"aHR0cHM6Ly91b3MudW5pdHkuY24vYXBwcw==\">UOS Developer Portal (unity.cn)</span></li>\n</ul>\n",
            "tags": [
                "热更新",
                "资源管理"
            ]
        },
        {
            "id": "https://www.fasty97.top/2020/09/11/Unity%E7%83%AD%E6%9B%B4%E6%96%B0%E5%88%9D%E6%AD%A5/",
            "url": "https://www.fasty97.top/2020/09/11/Unity%E7%83%AD%E6%9B%B4%E6%96%B0%E5%88%9D%E6%AD%A5/",
            "title": "Unity热更新初步",
            "date_published": "2020-09-11T04:21:41.000Z",
            "content_html": "<blockquote>\n<p>此文为热更新学习笔记记录</p>\n</blockquote>\n<h3 id=\"ab包\"><a class=\"markdownIt-Anchor\" href=\"#ab包\">#</a> AB 包</h3>\n<p><img data-src=\"https://pic.fasty97.top/blog/20200911/aMXVGwgBYNkX.png\" alt=\"AB包浏览器\"><br>\n<img data-src=\"https://pic.fasty97.top/blog/20200911/8uaUFBUnpFsG.png\" alt=\"AB包配置\"></p>\n<ul>\n<li>LZ4 比标准压缩程度小，但对于内存的占用相对较小，在使用时无需全部解压（<strong>推荐使用</strong>）</li>\n<li>ETI 在资源包中不包含资源的类型信息</li>\n<li>FR 重新打包时需要重新构建包和 ClearFolders 不同，它不会删除不存在的包。</li>\n<li>ITTC 增量构建检查时，忽略类型数的更改</li>\n<li>Append Hash 将文件哈希值附加到资源包名上</li>\n<li>SM 严格模式，如果打包出错，则打包直接失败</li>\n<li>DRB 运行时构建</li>\n</ul>\n<h4 id=\"打包\"><a class=\"markdownIt-Anchor\" href=\"#打包\">#</a> 打包</h4>\n<p>进过 AB 打包后，我们发现生成了如下的文件：<br>\n<img data-src=\"https://pic.fasty97.top/blog/20200911/OOvX2aB3ieJj.png\" alt=\"打包生成文件\"><br>\n其中包含我们的<strong>主包文件</strong> PC 和我们的资源包文件 model。<br>\n打包完成的资源包以<strong>二进制存储</strong><br>\n manifest 文件为对应资源的配置文件。<br>\n<img data-src=\"https://pic.fasty97.top/blog/20200911/2xEeB6noUX5c.png\" alt=\"AB包资源浏览\"></p>\n<h3 id=\"加载资源\"><a class=\"markdownIt-Anchor\" href=\"#加载资源\">#</a> 加载资源</h3>\n<figure class=\"highlight csharp\"><figcaption data-lang=\"C#\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 加载 AB 包</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token class-name\"><span class=\"token keyword\">var</span></span> ab<span class=\"token operator\">=</span> AssetBundle<span class=\"token punctuation\">.</span><span class=\"token function\">LoadFromFile</span><span class=\"token punctuation\">(</span>Application<span class=\"token punctuation\">.</span>streamingAssetsPath <span class=\"token operator\">+</span> <span class=\"token string\">\"/model\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">// 加载资源</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token class-name\"><span class=\"token keyword\">var</span></span> asset<span class=\"token operator\">=</span> ab<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">LoadAsset</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>GameObject<span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Cube\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">Instantiate</span><span class=\"token punctuation\">(</span>asset<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">// 注意 Ab 包不能重复加载（否则会出错）</span></pre></td></tr></table></figure><h4 id=\"异步加载资源\"><a class=\"markdownIt-Anchor\" href=\"#异步加载资源\">#</a> 异步加载资源</h4>\n<figure class=\"highlight csharp\"><figcaption data-lang=\"C#\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">/// &lt;summary></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">/// 异步加载资源</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/// &lt;/summary></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">/// &lt;param name=\"abName\">&lt;/param></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">/// &lt;param name=\"resName\">&lt;/param></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">/// &lt;param name=\"callBack\">&lt;/param></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">/// &lt;typeparam name=\"T\">&lt;/typeparam></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">/// &lt;returns>&lt;/returns></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token return-type class-name\">IEnumerator</span> <span class=\"token generic-method\"><span class=\"token function\">LoadAbResAsync</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>T<span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token class-name\"><span class=\"token keyword\">string</span></span> abName<span class=\"token punctuation\">,</span> <span class=\"token class-name\"><span class=\"token keyword\">string</span></span> resName<span class=\"token punctuation\">,</span> <span class=\"token class-name\">UnityAction<span class=\"token punctuation\">&lt;</span>AssetBundleRequest<span class=\"token punctuation\">></span></span> callBack<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token class-name\"><span class=\"token keyword\">var</span></span> ab <span class=\"token operator\">=</span> AssetBundle<span class=\"token punctuation\">.</span><span class=\"token function\">LoadFromFileAsync</span><span class=\"token punctuation\">(</span>Application<span class=\"token punctuation\">.</span>streamingAssetsPath <span class=\"token operator\">+</span> <span class=\"token string\">\"/model\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token keyword\">yield</span> <span class=\"token keyword\">return</span> ab<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token class-name\"><span class=\"token keyword\">var</span></span> res <span class=\"token operator\">=</span> ab<span class=\"token punctuation\">.</span>assetBundle<span class=\"token punctuation\">.</span><span class=\"token generic-method\"><span class=\"token function\">LoadAssetAsync</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>T<span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span>resName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\t<span class=\"token keyword\">yield</span> <span class=\"token keyword\">return</span> res<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>\tcallBack<span class=\"token punctuation\">.</span><span class=\"token function\">Invoke</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>\t<span class=\"token comment\">// 卸载单个 ab 包</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>\tab<span class=\"token punctuation\">.</span>assetBundle<span class=\"token punctuation\">.</span><span class=\"token function\">Unload</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>\t</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>\t<span class=\"token comment\">// 卸载所有 Ab 包，选 true 会删除场景上通过 ab 包加载的资源</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>\tAssetBundle<span class=\"token punctuation\">.</span><span class=\"token function\">UnloadAllAssetBundles</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><figure class=\"highlight csharp\"><figcaption data-lang=\"C#\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// 异步加载</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">StartCoroutine</span><span class=\"token punctuation\">(</span><span class=\"token generic-method\"><span class=\"token function\">LoadAbResAsync</span><span class=\"token generic class-name\"><span class=\"token punctuation\">&lt;</span>GameObject<span class=\"token punctuation\">></span></span></span><span class=\"token punctuation\">(</span><span class=\"token string\">\"model\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Cube\"</span><span class=\"token punctuation\">,</span> a <span class=\"token operator\">=></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    Debug<span class=\"token punctuation\">.</span><span class=\"token function\">Log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"资源加载完成！\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token function\">Instantiate</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">.</span>asset<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr></table></figure><h3 id=\"资源依赖\"><a class=\"markdownIt-Anchor\" href=\"#资源依赖\">#</a> 资源依赖</h3>\n<p>如果一个资源被打包为 ab 包，那么这个资源使用的其他资源依赖会被默认打入资源包。</p>\n",
            "tags": [
                "unity",
                "热更新"
            ]
        }
    ]
}