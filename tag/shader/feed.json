{
    "version": "https://jsonfeed.org/version/1",
    "title": "指尖小屋 • All posts by \"shader\" tag",
    "description": "学习的过程大概就是学了忘,忘了学，抽空多停下来总结，不要冲的太前。",
    "home_page_url": "https://www.fasty97.top",
    "items": [
        {
            "id": "https://www.fasty97.top/2022/12/26/Unity%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89%E8%AE%A9%E7%94%BB%E9%9D%A2%E5%8A%A8%E8%B5%B7%E6%9D%A5/",
            "url": "https://www.fasty97.top/2022/12/26/Unity%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%EF%BC%88%E5%8D%81%E4%B8%80%EF%BC%89%E8%AE%A9%E7%94%BB%E9%9D%A2%E5%8A%A8%E8%B5%B7%E6%9D%A5/",
            "title": "Unity入门精要（十一）让画面动起来",
            "date_published": "2022-12-26T03:34:17.000Z",
            "content_html": "<h2 id=\"unityshader的内置时间变量\"><a class=\"markdownIt-Anchor\" href=\"#unityshader的内置时间变量\">#</a> UnityShader 的内置时间变量</h2>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202212261137373.png\" alt=\"image-20221226113747301\"></p>\n<h2 id=\"序列帧动画\"><a class=\"markdownIt-Anchor\" href=\"#序列帧动画\">#</a> 序列帧动画</h2>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202212261519510.gif\" alt=\"\"></p>\n<blockquote>\n<p>通过使用 Time 实现循环的特效播放。</p>\n</blockquote>\n<figure class=\"highlight glsl\"><figcaption data-lang=\"GLSL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Shader <span class=\"token string\">\"Unlit/Exp2Shader\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    Properties</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token function\">_Color</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"Color Tint\"</span><span class=\"token punctuation\">,</span>Color<span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token function\">_MainTex</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"Texture\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span>D<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"white\"</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token function\">_HorizontalAmount</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Horizontal Amount\"</span><span class=\"token punctuation\">,</span>Float<span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token function\">_VerticalAmount</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Vertical Amount\"</span><span class=\"token punctuation\">,</span>Float<span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">4</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token function\">_Speed</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Speed\"</span><span class=\"token punctuation\">,</span><span class=\"token function\">Range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">30</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    SubShader</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        Tags</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>            <span class=\"token string\">\"Queue\"</span><span class=\"token operator\">=</span><span class=\"token string\">\"Transparent\"</span> <span class=\"token string\">\"IgnoreProjector\"</span><span class=\"token operator\">=</span><span class=\"token string\">\"True\"</span> <span class=\"token string\">\"RenderType\"</span><span class=\"token operator\">=</span><span class=\"token string\">\"Transparent\"</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        Pass</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            CGPROGRAM</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">vertex vert</span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">fragment frag</span></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token comment\">// make fog work</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">multi_compile_fog</span></span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            <span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"UnityCG.cginc\"</span></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            <span class=\"token keyword\">struct</span> <span class=\"token class-name\">appdata</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                float4 vertex <span class=\"token operator\">:</span> POSITION<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>                float2 uv <span class=\"token operator\">:</span> TEXCOORD0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            <span class=\"token keyword\">struct</span> <span class=\"token class-name\">v2f</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>                float2 uv <span class=\"token operator\">:</span> TEXCOORD0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>                float4 vertex <span class=\"token operator\">:</span> SV_POSITION<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>            <span class=\"token keyword\">sampler2D</span> _MainTex<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>            float4 _MainTex_ST<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            v2f <span class=\"token function\">vert</span><span class=\"token punctuation\">(</span>appdata v<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>                v2f o<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>                o<span class=\"token punctuation\">.</span>vertex <span class=\"token operator\">=</span> <span class=\"token function\">UnityObjectToClipPos</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>vertex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>                o<span class=\"token punctuation\">.</span>uv <span class=\"token operator\">=</span> <span class=\"token function\">TRANSFORM_TEX</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>uv<span class=\"token punctuation\">,</span> _MainTex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>                <span class=\"token keyword\">return</span> o<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>            <span class=\"token keyword\">float</span> _Speed<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>            <span class=\"token keyword\">float</span> _HorizontalAmount<span class=\"token punctuation\">,</span> _VerticalAmount<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>            fixed4 _Color<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>            fixed4 <span class=\"token function\">frag</span><span class=\"token punctuation\">(</span>v2f i<span class=\"token punctuation\">)</span> <span class=\"token operator\">:</span> SV_Target</pre></td></tr><tr><td data-num=\"56\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>                <span class=\"token keyword\">float</span> time <span class=\"token operator\">=</span> <span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>_Time<span class=\"token punctuation\">.</span>y <span class=\"token operator\">*</span> _Speed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>                <span class=\"token keyword\">float</span> row <span class=\"token operator\">=</span> <span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>time <span class=\"token operator\">/</span> _HorizontalAmount<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>                <span class=\"token keyword\">float</span> column <span class=\"token operator\">=</span> time <span class=\"token operator\">-</span> row <span class=\"token operator\">*</span> _VerticalAmount<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>                half2 uv <span class=\"token operator\">=</span> i<span class=\"token punctuation\">.</span>uv <span class=\"token operator\">+</span> <span class=\"token function\">half2</span><span class=\"token punctuation\">(</span>column<span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span>row<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>                uv<span class=\"token punctuation\">.</span>x <span class=\"token operator\">/=</span> _HorizontalAmount<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>                uv<span class=\"token punctuation\">.</span>y <span class=\"token operator\">/=</span> _VerticalAmount<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>                fixed4 c <span class=\"token operator\">=</span> <span class=\"token function\">tex2D</span><span class=\"token punctuation\">(</span>_MainTex<span class=\"token punctuation\">,</span> uv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>                c<span class=\"token punctuation\">.</span>rgb <span class=\"token operator\">*=</span> _Color<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>                <span class=\"token keyword\">return</span> c<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>            ENDCG</pre></td></tr><tr><td data-num=\"71\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span>   </pre></td></tr><tr><td data-num=\"72\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span>    Fallback <span class=\"token string\">\"Transparent/VertexLit\"</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre></pre></td></tr><tr><td data-num=\"74\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"无限滚动背景\"><a class=\"markdownIt-Anchor\" href=\"#无限滚动背景\">#</a> 无限滚动背景</h2>\n<p>很多无限滚动的背景也是使用了纹理动画。纹理资源： <span class=\"exturl\" data-url=\"aHR0cHM6Ly9vcGVuZ2FtZWFydC5vcmcv\">OpenGameArt.org</span></p>\n<blockquote>\n<p>注意： uv 现已经不存在 zw 值。</p>\n</blockquote>\n<figure class=\"highlight csharp\"><figcaption data-lang=\"C#\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Shader <span class=\"token string\">\"Unlit/BackGroundShader\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    Properties</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        _MainTex <span class=\"token punctuation\">(</span><span class=\"token string\">\"Texture\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2D</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"white\"</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>        <span class=\"token function\">_DetailTex</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"2nd Layer (RGB)\"</span><span class=\"token punctuation\">,</span><span class=\"token number\">2D</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token string\">\"white\"</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token function\">_ScrollX</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Base Layer Scrool Speed\"</span><span class=\"token punctuation\">,</span>Float<span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">1.0</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token function\">_Scroll2X</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"2nd Layer Scroll Speed\"</span><span class=\"token punctuation\">,</span>Float<span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">1.0</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token function\">_Multiplier</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Layer Multiplier\"</span><span class=\"token punctuation\">,</span>Float<span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    SubShader</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        Tags</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>            <span class=\"token string\">\"RenderType\"</span><span class=\"token operator\">=</span><span class=\"token string\">\"Opaque\"</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        LOD <span class=\"token number\">100</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        Pass</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>            CGPROGRAM</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>            <span class=\"token preprocessor property\">#<span class=\"token directive keyword\">pragma</span> vertex vert</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>            <span class=\"token preprocessor property\">#<span class=\"token directive keyword\">pragma</span> fragment frag</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>            <span class=\"token comment\">// make fog work</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>            <span class=\"token preprocessor property\">#<span class=\"token directive keyword\">pragma</span> multi_compile_fog</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            <span class=\"token preprocessor property\">#include </span><span class=\"token string\">\"UnityCG.cginc\"</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>            <span class=\"token keyword\">struct</span> <span class=\"token class-name\">appdata</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>                <span class=\"token class-name\">float4</span> vertex <span class=\"token punctuation\">:</span> POSITION<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>                <span class=\"token class-name\">float2</span> uv <span class=\"token punctuation\">:</span> TEXCOORD0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>            <span class=\"token keyword\">struct</span> <span class=\"token class-name\">v2f</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>                <span class=\"token class-name\">float2</span> uv <span class=\"token punctuation\">:</span> TEXCOORD0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>                <span class=\"token function\">UNITY_FOG_COORDS</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>                <span class=\"token class-name\">float4</span> vertex <span class=\"token punctuation\">:</span> SV_POSITION<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>            <span class=\"token class-name\">sampler2D</span> _MainTex<span class=\"token punctuation\">,</span> _DetailTex<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>            <span class=\"token class-name\">float4</span> _MainTex_ST<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            <span class=\"token class-name\"><span class=\"token keyword\">float</span></span> _ScrollX<span class=\"token punctuation\">,</span> _Scroll2X<span class=\"token punctuation\">,</span> _Multiplier<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>            <span class=\"token class-name\">float4</span> _DetailTex_ST<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>            <span class=\"token return-type class-name\">v2f</span> <span class=\"token function\">vert</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">appdata</span> v<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>                <span class=\"token class-name\">v2f</span> o<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>                o<span class=\"token punctuation\">.</span>vertex <span class=\"token operator\">=</span> <span class=\"token function\">UnityObjectToClipPos</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>vertex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>                o<span class=\"token punctuation\">.</span>uv<span class=\"token punctuation\">.</span>xy <span class=\"token operator\">=</span> <span class=\"token function\">TRANSFORM_TEX</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>uv<span class=\"token punctuation\">,</span> _MainTex<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">frac</span><span class=\"token punctuation\">(</span><span class=\"token function\">float2</span><span class=\"token punctuation\">(</span>_ScrollX<span class=\"token punctuation\">,</span> <span class=\"token number\">0.0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> _Time<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>                o<span class=\"token punctuation\">.</span>uv<span class=\"token punctuation\">.</span>zw <span class=\"token operator\">=</span> <span class=\"token function\">TRANSFORM_TEX</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>uv<span class=\"token punctuation\">,</span> _DetailTex<span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token function\">frac</span><span class=\"token punctuation\">(</span><span class=\"token function\">float2</span><span class=\"token punctuation\">(</span>_Scroll2X<span class=\"token punctuation\">,</span> <span class=\"token number\">0.0</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> _Time<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>                <span class=\"token function\">UNITY_TRANSFER_FOG</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">,</span> o<span class=\"token punctuation\">.</span>vertex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>                <span class=\"token keyword\">return</span> o<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>            <span class=\"token return-type class-name\">fixed4</span> <span class=\"token function\">frag</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">v2f</span> i<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> SV_Target</pre></td></tr><tr><td data-num=\"58\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>                <span class=\"token class-name\">fixed4</span> firstLayer <span class=\"token operator\">=</span> <span class=\"token function\">tex2D</span><span class=\"token punctuation\">(</span>_MainTex<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>uv<span class=\"token punctuation\">.</span>xy<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>                <span class=\"token class-name\">fixed4</span> secondLayer <span class=\"token operator\">=</span> <span class=\"token function\">tex2D</span><span class=\"token punctuation\">(</span>_DetailTex<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>uv<span class=\"token punctuation\">.</span>zw<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>                <span class=\"token class-name\">fixed4</span> c <span class=\"token operator\">=</span> <span class=\"token function\">lerp</span><span class=\"token punctuation\">(</span>firstLayer<span class=\"token punctuation\">,</span> secondLayer<span class=\"token punctuation\">,</span> secondLayer<span class=\"token punctuation\">.</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre>                c<span class=\"token punctuation\">.</span>rgb <span class=\"token operator\">*=</span> _Multiplier<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"64\"></td><td><pre></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>                <span class=\"token keyword\">return</span> c<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre>            ENDCG</pre></td></tr><tr><td data-num=\"68\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>    Fallback <span class=\"token string\">\"VertexLit\"</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h2 id=\"顶点动画\"><a class=\"markdownIt-Anchor\" href=\"#顶点动画\">#</a> 顶点动画</h2>\n",
            "tags": [
                "Shader",
                "读书笔记"
            ]
        },
        {
            "id": "https://www.fasty97.top/2022/12/26/Unity%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%EF%BC%88%E4%B8%83%EF%BC%89%20%E5%9F%BA%E7%A1%80%E7%BA%B9%E7%90%86/",
            "url": "https://www.fasty97.top/2022/12/26/Unity%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%EF%BC%88%E4%B8%83%EF%BC%89%20%E5%9F%BA%E7%A1%80%E7%BA%B9%E7%90%86/",
            "title": "Unity入门精要（七）基础纹理",
            "date_published": "2022-12-26T03:13:00.000Z",
            "content_html": "<h1 id=\"unity-shader-第七章-基础纹理\"><a class=\"markdownIt-Anchor\" href=\"#unity-shader-第七章-基础纹理\">#</a> Unity Shader 第七章 基础纹理</h1>\n<blockquote>\n<p>纹理 —— 使用一张图片来控制模型的外观，使用纹理映射技术把一张图黏在模型表面，逐纹素地控制模型的颜色。</p>\n</blockquote>\n<p>通常使用纹理映射坐标对应纹理中的 2D 坐标，这被称为是 UV 坐标。</p>\n<p>顶点 UV 坐标的范围通常被归一到 [0,1] 范围内。</p>\n<p>DirectX 中原点位于左上角，OpenGL 中原点位于左下角。</p>\n<p Unity=\"\" 使用的是OpenGL的坐标，即原点位于左下角=\"\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle mathcolor=\"red\"></mstyle></mrow><annotation encoding=\"application/x-tex\">\\color{red}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"></span></span></p>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202209131416024.png\" alt=\"image-20220824104021468\"></p>\n<h2 id=\"纹理采样\"><a class=\"markdownIt-Anchor\" href=\"#纹理采样\">#</a> 纹理采样</h2>\n<figure class=\"highlight glsl\"><figcaption data-lang=\"GLSL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// Upgrade NOTE: replaced 'mul(UNITY_MATRIX_MVP,*)' with 'UnityObjectToClipPos(*)'</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Shader <span class=\"token string\">\"Book/SingleTexture\"</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    Properties</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token function\">_Color</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Color Tint\"</span><span class=\"token punctuation\">,</span>Color<span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token function\">_MainTex</span> <span class=\"token punctuation\">(</span><span class=\"token string\">\"Texture\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span>D<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"white\"</span> <span class=\"token punctuation\">&#123;</span><span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token comment\">//        反射</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token function\">_Specular</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Specular\"</span><span class=\"token punctuation\">,</span>Color<span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>        <span class=\"token comment\">//        高光</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>        <span class=\"token function\">_Gloss</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Gloss\"</span><span class=\"token punctuation\">,</span><span class=\"token function\">Range</span><span class=\"token punctuation\">(</span><span class=\"token number\">8.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">256</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">=</span><span class=\"token number\">20</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    SubShader</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        Tags</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>            <span class=\"token string\">\"RenderType\"</span><span class=\"token operator\">=</span><span class=\"token string\">\"Opaque\"</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>            <span class=\"token string\">\"LightMode\"</span><span class=\"token operator\">=</span><span class=\"token string\">\"ForwardBase\"</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>        LOD <span class=\"token number\">100</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        Pass</pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>            CGPROGRAM</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>            <span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">vertex vert</span></span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>            <span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">fragment frag</span></span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>            <span class=\"token comment\">// make fog work</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>            <span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">multi_compile_fog</span></span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>            <span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"UnityCG.cginc\"</span></span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>            <span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"Lighting.cginc\"</span></span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>            <span class=\"token comment\">// 声明对应变量</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>            fixed4 _Color<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>            <span class=\"token keyword\">sampler2D</span> _MainTex<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>            float4 _MainTex_ST<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>            fixed4 _Specular<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>            <span class=\"token keyword\">float</span> _Gloss<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>            <span class=\"token comment\">// 输入</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>            <span class=\"token keyword\">struct</span> <span class=\"token class-name\">a2v</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>                float4 vertex<span class=\"token operator\">:</span> POSITION<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>                float3 normal<span class=\"token operator\">:</span> NORMAL<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>                float4 texcoord<span class=\"token operator\">:</span> TEXCOORD0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>            <span class=\"token keyword\">struct</span> <span class=\"token class-name\">v2f</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>                float4 pos<span class=\"token operator\">:</span> SV_POSITION<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>                float3 worldNormal<span class=\"token operator\">:</span> TEXCOORD0<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>                float3 worldPos<span class=\"token operator\">:</span> TEXCOORD1<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>                float2 uv<span class=\"token operator\">:</span> TEXCOORD2<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>            <span class=\"token comment\">// 进行顶点着色器</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>            v2f <span class=\"token function\">vert</span><span class=\"token punctuation\">(</span>a2v v<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre>                v2f o<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre></pre></td></tr><tr><td data-num=\"64\"></td><td><pre>                o<span class=\"token punctuation\">.</span>pos <span class=\"token operator\">=</span> <span class=\"token function\">UnityObjectToClipPos</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>vertex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre>                o<span class=\"token punctuation\">.</span>worldNormal <span class=\"token operator\">=</span> <span class=\"token function\">UnityObjectToWorldNormal</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">.</span>normal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"66\"></td><td><pre>                o<span class=\"token punctuation\">.</span>worldPos <span class=\"token operator\">=</span> <span class=\"token function\">mul</span><span class=\"token punctuation\">(</span>unity_ObjectToWorld<span class=\"token punctuation\">,</span> v<span class=\"token punctuation\">.</span>vertex<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>xyz<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"67\"></td><td><pre></pre></td></tr><tr><td data-num=\"68\"></td><td><pre>                <span class=\"token comment\">// 计算 Thing And Offset</span></pre></td></tr><tr><td data-num=\"69\"></td><td><pre>                o<span class=\"token punctuation\">.</span>uv <span class=\"token operator\">=</span> v<span class=\"token punctuation\">.</span>texcoord<span class=\"token punctuation\">.</span>xy <span class=\"token operator\">*</span> _MainTex_ST<span class=\"token punctuation\">.</span>xy <span class=\"token operator\">+</span> _MainTex_ST<span class=\"token punctuation\">.</span>zw<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"70\"></td><td><pre>                <span class=\"token comment\">// 可使用 Unity 内置宏</span></pre></td></tr><tr><td data-num=\"71\"></td><td><pre>                <span class=\"token comment\">// o.uv = TRANSFORM_TEX(v.texcoord, _MainTex);</span></pre></td></tr><tr><td data-num=\"72\"></td><td><pre>                <span class=\"token keyword\">return</span> o<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"73\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"74\"></td><td><pre></pre></td></tr><tr><td data-num=\"75\"></td><td><pre>            <span class=\"token comment\">// 进行片元着色器</span></pre></td></tr><tr><td data-num=\"76\"></td><td><pre>            fixed4 <span class=\"token function\">frag</span><span class=\"token punctuation\">(</span>v2f i<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> SV_Target</pre></td></tr><tr><td data-num=\"77\"></td><td><pre>            <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"78\"></td><td><pre>                <span class=\"token comment\">// 光线方向</span></pre></td></tr><tr><td data-num=\"79\"></td><td><pre>                fixed3 worldNormal <span class=\"token operator\">=</span> <span class=\"token function\">normalize</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>worldNormal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"80\"></td><td><pre>                fixed3 worldLightDir <span class=\"token operator\">=</span> <span class=\"token function\">normalize</span><span class=\"token punctuation\">(</span><span class=\"token function\">UnityWorldSpaceLightDir</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>worldPos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"81\"></td><td><pre></pre></td></tr><tr><td data-num=\"82\"></td><td><pre>                <span class=\"token comment\">// 纹理采样</span></pre></td></tr><tr><td data-num=\"83\"></td><td><pre>                fixed3 albedo <span class=\"token operator\">=</span> <span class=\"token function\">tex2D</span><span class=\"token punctuation\">(</span>_MainTex<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">.</span>uv<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>rgb <span class=\"token operator\">*</span> _Color<span class=\"token punctuation\">.</span>rgb<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"84\"></td><td><pre>                <span class=\"token comment\">// 环境光</span></pre></td></tr><tr><td data-num=\"85\"></td><td><pre>                fixed3 ambient <span class=\"token operator\">=</span> UNITY_LIGHTMODEL_AMBIENT<span class=\"token punctuation\">.</span>xyz <span class=\"token operator\">*</span> albedo<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"86\"></td><td><pre></pre></td></tr><tr><td data-num=\"87\"></td><td><pre>                <span class=\"token comment\">// 漫反射 - 半兰伯特模型</span></pre></td></tr><tr><td data-num=\"88\"></td><td><pre>                fixed3 diffuse <span class=\"token operator\">=</span> _LightColor0<span class=\"token punctuation\">.</span>rgb <span class=\"token operator\">*</span> albedo <span class=\"token operator\">*</span> <span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">dot</span><span class=\"token punctuation\">(</span>worldNormal<span class=\"token punctuation\">,</span> worldLightDir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"89\"></td><td><pre></pre></td></tr><tr><td data-num=\"90\"></td><td><pre>                fixed3 viewDir <span class=\"token operator\">=</span> <span class=\"token function\">normalize</span><span class=\"token punctuation\">(</span><span class=\"token function\">UnityWorldSpaceViewDir</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">.</span>worldPos<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"91\"></td><td><pre></pre></td></tr><tr><td data-num=\"92\"></td><td><pre>                fixed3 halfDir <span class=\"token operator\">=</span> <span class=\"token function\">normalize</span><span class=\"token punctuation\">(</span>worldLightDir <span class=\"token operator\">+</span> viewDir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"93\"></td><td><pre>                <span class=\"token comment\">// 高光反射</span></pre></td></tr><tr><td data-num=\"94\"></td><td><pre>                fixed3 specular <span class=\"token operator\">=</span> _LightColor0<span class=\"token punctuation\">.</span>rgb <span class=\"token operator\">*</span> _Specular<span class=\"token punctuation\">.</span>rgb <span class=\"token operator\">*</span> <span class=\"token function\">pow</span><span class=\"token punctuation\">(</span><span class=\"token function\">max</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token function\">dot</span><span class=\"token punctuation\">(</span>worldNormal<span class=\"token punctuation\">,</span> halfDir<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> _Gloss<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"95\"></td><td><pre></pre></td></tr><tr><td data-num=\"96\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token function\">fixed4</span><span class=\"token punctuation\">(</span>ambient <span class=\"token operator\">+</span> diffuse <span class=\"token operator\">+</span> specular<span class=\"token punctuation\">,</span> <span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"97\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"98\"></td><td><pre>            ENDCG</pre></td></tr><tr><td data-num=\"99\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"100\"></td><td><pre></pre></td></tr><tr><td data-num=\"101\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"102\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"103\"></td><td><pre>    Fallback <span class=\"token string\">\"Specular\"</span></pre></td></tr><tr><td data-num=\"104\"></td><td><pre></pre></td></tr><tr><td data-num=\"105\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p><img data-src=\"http://pic.fasty97.top/NotePad/202209131416080.png\" alt=\"image-20220824164058414\"></p>\n<p>值得注意的是：</p>\n<blockquote>\n<p>如果导入的纹理大小超过了 Max Texture Size 中的设置值，那么 Unity 将会把该纹理缩放为这个最大分辨率。理想情况下，导入的纹理可以是非正方形的，但长宽的大小应该是 2 的幂，例如 2、4、8、16、32、64 等。如果使用了非 2 的幂大小（Non Power of Two, NPOT）的纹理，那么这些纹理往往会占用更多的内存空间，而且 GPU 读取该纹理的速度也会有所下降。有一些平台甚至不支持这种 NPOT 纹理，这时 Unity 在内部会把它缩放成最近的 2 的幂大小。出于性能和空间的考虑，我们应该尽量使用 2 的幂大小的纹理。</p>\n</blockquote>\n<h2 id=\"凹凸映射\"><a class=\"markdownIt-Anchor\" href=\"#凹凸映射\">#</a> 凹凸映射</h2>\n<p>纹理的一种应用是凹凸映射（使用一张纹理来修改模型表面的法线，以便为模型提供更多的细节。）——++ 法线贴图 ++。</p>\n<p>有以下两种映射方式【高度纹理，法线纹理】：</p>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202209131416788.png\" alt=\"image-20220830094021154\"></p>\n<h3 id=\"高度纹理\"><a class=\"markdownIt-Anchor\" href=\"#高度纹理\">#</a> 高度纹理</h3>\n<p>存储颜色强度值来表示海拔高度，颜色越深表面越向外凸起，颜色越钱表面越向内凹陷。</p>\n<p>优点：直观明显</p>\n<p>缺点：计算复杂，不能实时计算得到表面法线，消耗性能。</p>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202209131416546.png\" alt=\"image-20220830094546307\"></p>\n<h3 id=\"法线纹理\"><a class=\"markdownIt-Anchor\" href=\"#法线纹理\">#</a> 法线纹理</h3>\n<p>存储表面法线方向，范围值为 [-1,1], 而像素分量范围为 [0,1]，需要进行映射。</p>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202209131417006.png\" alt=\"image-20220830094820422\"></p>\n<p>在对法线纹理进行采样后，还需要对结果进行一次反映射得到法线方向：</p>\n<p><code>normal=pixel*2-1</code></p>\n<p>根据使用的坐标系分为：</p>\n<ol>\n<li>\n<p>模型空间的法线纹理</p>\n<p>因为法线方向各不相同，在对应到贴图上是会呈现出不同的颜色，不同的颜色就对应不同的法线方向。—— 直观</p>\n</li>\n<li>\n<p>切线空间的法线纹理</p>\n<p>切线空间下的法线则呈现浅蓝色</p>\n</li>\n</ol>\n",
            "tags": [
                "Shader",
                "读书笔记"
            ]
        },
        {
            "id": "https://www.fasty97.top/2022/09/20/Unity%20UI%E5%90%88%E6%89%B9/",
            "url": "https://www.fasty97.top/2022/09/20/Unity%20UI%E5%90%88%E6%89%B9/",
            "title": "Unity Ui 合批学习",
            "date_published": "2022-09-20T13:15:09.000Z",
            "content_html": "<h1 id=\"unity-ui-合批学习\"><a class=\"markdownIt-Anchor\" href=\"#unity-ui-合批学习\">#</a> Unity Ui 合批学习</h1>\n<h2 id=\"stats-统计面板\"><a class=\"markdownIt-Anchor\" href=\"#stats-统计面板\">#</a> Stats 统计面板</h2>\n<blockquote>\n<p>stats 面板可以展示摄像机范围内，所有游戏对象元素的顶点、面片、批处理次数、CPU 耗时等。</p>\n</blockquote>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202209191011750.png\" alt=\"image-20220919101137617\"></p>\n<table>\n<thead>\n<tr>\n<th>参数</th>\n<th>说明</th>\n<th>备注</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>tris</td>\n<td>三角形面数</td>\n<td></td>\n</tr>\n<tr>\n<td>verts</td>\n<td>顶点数</td>\n<td></td>\n</tr>\n<tr>\n<td>Batches</td>\n<td>批处理个数</td>\n<td></td>\n</tr>\n<tr>\n<td>Saved By batching</td>\n<td>批处理被合并后的批处理个数</td>\n<td>实际执行的批处理个数 Draw Call</td>\n</tr>\n<tr>\n<td>CPU</td>\n<td>cpu 执行耗时</td>\n<td></td>\n</tr>\n<tr>\n<td>FPS</td>\n<td>时间段执行次数</td>\n<td>流畅度</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"天空盒子\"><a class=\"markdownIt-Anchor\" href=\"#天空盒子\">#</a> 天空盒子</h3>\n<blockquote>\n<p>新建一个场景发现，有 1.7k 的三角和 5k 的顶点。</p>\n<p>++ 这些顶点和三角面其实来源于天空盒，天空盒也是一个模型。 ++</p>\n</blockquote>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202209191019934.png\" alt=\"image-20220919101907862\"></p>\n<p>修改为适用纯色背景：</p>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202211281448056.png\" alt=\"image-20221128144803967\"></p>\n<p>可以看到此时，降低到了 2 个三角面和 4 个顶点。如下图所示的分割情况.</p>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202211281449253.png\" alt=\"image-20221128144922221\"></p>\n<h2 id=\"批处理\"><a class=\"markdownIt-Anchor\" href=\"#批处理\">#</a> 批处理</h2>\n<blockquote>\n<p>我们最常看到的优化技术大概就是批处理了。批处理的实现原理就是为了减少每一帧需要的 draw call 数目。为了把一个对象渲染到屏幕上，CPU 需要检查哪些光源影响了该物体，绑定 Shader 被设置它的参数，再把渲染纹理发送给 GPU。当场景中包含了大量对象时，这些操作就会非常耗时。一个极端的例子是， <code>如果我们需要渲染一千个三角形，把它们按一千个单独的网格进行渲染所花费的时间要远远大于渲染一个包含了一千个三角形的网格。在这两种情况下，GPU的性能消耗其实并没有多大的区别，但CPU的draw call数目就会成为性能瓶颈。</code> 因此，批处理的思想很简单，就是在每次面对 draw call 时尽可能多地处理多个物体。<br>\n使用同一个材质的物体可以一起处理。对于使用同一个材质的物体，它们之间的不同仅仅在于顶点数据的差别。我们可以把这些顶点数据合并在一起，再一起发送给 GPU，就可以完成一次批处理。</p>\n</blockquote>\n<h3 id=\"batches和saved-by-batching\"><a class=\"markdownIt-Anchor\" href=\"#batches和saved-by-batching\">#</a> Batches 和 Saved by batching</h3>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202211281518976.png\" alt=\"image-20221128151826942\"></p>\n<ul>\n<li>Batches 表示批处理次数</li>\n<li>Saved byBatching 表示节省的批处理次数</li>\n</ul>\n<h3 id=\"动态批处理和静态批处理\"><a class=\"markdownIt-Anchor\" href=\"#动态批处理和静态批处理\">#</a> 动态批处理和静态批处理</h3>\n<p>将物体标记为 <code>Static</code>  可以大幅优化批处理。—— 静态批处理</p>\n<h2 id=\"参考资料\"><a class=\"markdownIt-Anchor\" href=\"#参考资料\">#</a> 参考资料</h2>\n<ol>\n<li>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzI1NDE1MDk1L2FydGljbGUvZGV0YWlscy8xMTIzODg2Mzg=\">Unity3D UGUI 系列之合批_WangShade 的博客 - CSDN 博客_ugui 合批</span></p>\n</li>\n<li>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzI1NDE1MDk1L2FydGljbGUvZGV0YWlscy8xMDQzODM3Mzg=\">Unity3D 客户端项目优化总结之 Stats 统计面板_WangShade 的博客 - CSDN 博客</span></p>\n</li>\n<li>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzI1NDE1MDk1L2FydGljbGUvZGV0YWlscy8xMDQ0MTk1NzE=\">Unity3D 客户端项目优化总结之静态批处理 Static Batching_WangShade 的博客 - CSDN 博客</span></p>\n</li>\n</ol>\n",
            "tags": [
                "Shader",
                "ui",
                "性能优化"
            ]
        },
        {
            "id": "https://www.fasty97.top/2022/09/20/Unity%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%EF%BC%88%E5%8D%81%EF%BC%89%E9%AB%98%E7%BA%A7%E7%BA%B9%E7%90%86/",
            "url": "https://www.fasty97.top/2022/09/20/Unity%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%EF%BC%88%E5%8D%81%EF%BC%89%E9%AB%98%E7%BA%A7%E7%BA%B9%E7%90%86/",
            "title": "Unity入门精要（十）高级纹理",
            "date_published": "2022-09-20T13:14:05.000Z",
            "content_html": "<h1 id=\"高级纹理\"><a class=\"markdownIt-Anchor\" href=\"#高级纹理\">#</a> 高级纹理</h1>\n<ul>\n<li>基础纹理：法线纹理、渐变纹理、遮罩纹理等。</li>\n<li>高级纹理：CubeMap、Render Texture、Procedure Texture</li>\n</ul>\n<h2 id=\"cubemap立方体纹理\"><a class=\"markdownIt-Anchor\" href=\"#cubemap立方体纹理\">#</a> CubeMap 立方体纹理</h2>\n<blockquote>\n<p>在图形学中，立方体纹理是环境映射的一种实现方法。</p>\n</blockquote>\n<img data-src=\"http://pic.fasty97.top/NotePad/202209131407838.png\" alt=\"image-20220913140753789\" style=\"zoom:50%;\" />\n<center>立方体纹理采样</center>\n<p>立方体纹理常常用于天空盒、环境映射。</p>\n",
            "tags": [
                "Shader",
                "读书笔记"
            ]
        },
        {
            "id": "https://www.fasty97.top/2022/05/20/Unity%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%EF%BC%88%E4%B9%9D%EF%BC%89%E5%A4%8D%E6%9D%82%E5%85%89%E7%85%A7/",
            "url": "https://www.fasty97.top/2022/05/20/Unity%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%EF%BC%88%E4%B9%9D%EF%BC%89%E5%A4%8D%E6%9D%82%E5%85%89%E7%85%A7/",
            "title": "Unity入门精要（九）复杂光照",
            "date_published": "2022-05-19T22:58:51.000Z",
            "content_html": "<h1 id=\"复杂光照\"><a class=\"markdownIt-Anchor\" href=\"#复杂光照\">#</a> 复杂光照</h1>\n<p>在之前的学习中，我们使用的都是单一光照，实际在游戏中可能存在多个光源，不同的光源会互相影响构成真正的光照系统，在这一节我们将实现一个真正可用的光照模型。</p>\n<h2 id=\"渲染路径-rendering-path\"><a class=\"markdownIt-Anchor\" href=\"#渲染路径-rendering-path\">#</a> 渲染路径 Rendering Path</h2>\n<blockquote>\n<p>📖 决定了光照是如何应用到 Unity Shader 中的。</p>\n</blockquote>\n<p>我们只有为 Shader 正确地选择和设置了需要的渲染路径，该 Shader 的光照计算才能被正确执行。</p>\n<p>🏷渲染路径的分类</p>\n<ul>\n<li>前向渲染路径（Forward Rendering Path）</li>\n<li>延迟渲染路径（Deferred Rendering Path）</li>\n<li>顶点照明渲染路径（Vertex Lit Rendering Path）—— 已经被弃用</li>\n</ul>\n<p>目前 unity 提供了新的渲染路径代替了原来的渲染路径。</p>\n<blockquote>\n<p>默认使用 Graphics 中的设置，可以在摄像机中对设置进行覆盖。</p>\n</blockquote>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202209021127030.png\" alt=\"image-20220902112709918\"></p>\n<p>在 Shader Pass 中来指定该 Pass 使用的渲染路径：</p>\n<figure class=\"highlight scss\"><figcaption data-lang=\"Sass (Scss)\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token selector\">Pass  </span><span class=\"token punctuation\">&#123;</span> <span class=\"token selector\">Tags  </span><span class=\"token punctuation\">&#123;</span>  <span class=\"token string\">\"LightMode\"</span>  =  <span class=\"token string\">\"ForwardBase\"</span>  <span class=\"token punctuation\">&#125;</span> <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>LightMode 标签可供使用的渲染路径：</p>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202209021129823.png\" alt=\"image-20220902112959760\"></p>\n<p>💭为 Pass 指定正确的渲染路径对于 Unity 光照变量正确赋值具有重要意义。</p>\n<blockquote>\n<p>Unity 默认使用前向渲染光照路径.</p>\n</blockquote>\n<h3 id=\"前向渲染路径\"><a class=\"markdownIt-Anchor\" href=\"#前向渲染路径\">#</a> 前向渲染路径</h3>\n<blockquote>\n<p>前向渲染是传统渲染方式，也是我们常用的一种渲染路径。</p>\n</blockquote>\n<p>📖 原理：每进行一次完整的前向渲染，我们需要渲染该对象的渲染图元，并计算两个缓冲区的信息：颜色缓冲区和深度缓冲区。</p>\n<center>前向渲染伪代码</center>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202209021402465.png\" alt=\"image-20220902140220407\"></p>\n<p>每个光照下的物体都需要进行一次逐像素的 Pass，也就是在一个场景中，n 个物体 m 个光源的下，渲染场景需要 n*m 次 Pass。</p>\n<h3 id=\"unity中的前向渲染\"><a class=\"markdownIt-Anchor\" href=\"#unity中的前向渲染\">#</a> Unity 中的前向渲染</h3>\n<p>Unity 中照亮物体有 3 种方式：</p>\n<ol>\n<li>逐顶点处理 Spherical</li>\n<li>逐像素处理 Harmonics</li>\n<li>球谐函数 SH</li>\n</ol>\n<p>光源使用哪一种处理方式取决于它的类型和渲染模式。</p>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202209021411344.png\" alt=\"image-20220902141112298\"></p>\n<blockquote>\n<p>将渲染类型设置为 Important（重要的）来告诉 Unity 这个光源是重要的，把它当成一个逐像素光源来处理。</p>\n<p>通常，Unity 会自动根据远近、强度等参数对光源的重要性进行排序。</p>\n</blockquote>\n<ul>\n<li>\n<p>场景中最亮的平行光总是按逐像素处理的。</p>\n</li>\n<li>\n<p>渲染模式被设置成 Not Important 的光源，会按逐顶点或者 SH 处理。・渲染模式被设置成 Important 的光源，会按逐像素处理。</p>\n</li>\n<li>\n<p>如果根据以上规则得到的逐像素光源数量小于 Quality Setting 中的逐像素光源数量 (Pixel Light Count)，会有更多的光源以逐像素的方式进行渲染。</p>\n</li>\n</ul>\n<h3 id=\"内置变量函数\"><a class=\"markdownIt-Anchor\" href=\"#内置变量函数\">#</a> 内置变量函数</h3>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202209021420443.png\" alt=\"image-20220902142017381\"></p>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202209021420246.png\" alt=\"image-20220902142034183\"></p>\n<h3 id=\"相关参考\"><a class=\"markdownIt-Anchor\" href=\"#相关参考\">#</a> 相关参考</h3>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC85Mzg0NjAwMA==\">Unity 渲染路径 - 知乎 (zhihu.com)</span></p>\n<h2 id=\"顶点照明渲染路径\"><a class=\"markdownIt-Anchor\" href=\"#顶点照明渲染路径\">#</a> 顶点照明渲染路径</h2>\n<blockquote>\n<p>顶点照明渲染路径是对硬件配置要求最少、运算性能最高，但同时也是得到的效果最差的一种类型，它不支持那些逐像素才能得到的效果，例如阴影、法线映射、高精度的高光反射等。</p>\n</blockquote>\n<p>📖同理，使用逐顶点的方式进行光照计算。—— 是前向渲染的一个子集。</p>\n<h2 id=\"延迟渲染路径\"><a class=\"markdownIt-Anchor\" href=\"#延迟渲染路径\">#</a> 延迟渲染路径</h2>\n<blockquote>\n<p>当场景中包含大量实时光源时，前向选人的性能会急速下降。</p>\n</blockquote>\n<p>除了前向渲染中使用的颜色缓冲和深度缓冲之外，延迟渲染还需要利用额外的缓冲 —— 这些缓冲被统称为 GBuffer。</p>\n<h3 id=\"原理\"><a class=\"markdownIt-Anchor\" href=\"#原理\">#</a> 原理</h3>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202209021438497.png\" alt=\"image-20220902143817442\"></p>\n<p>在光照计算 Pass 中直接存储法线，表面情况等，从 Gbuff 取到数据后直接在光照 Pass 中计算，故而延迟渲染和场景复杂度不挂钩，通常就只使用两个 Pass 完成故而效率较高。</p>\n<h3 id=\"缺点\"><a class=\"markdownIt-Anchor\" href=\"#缺点\">#</a> 缺点</h3>\n<ul>\n<li>不支持真正的抗锯齿（anti-aliasing）功能。</li>\n<li>不能处理半透明物体。</li>\n<li>对显卡有一定要求。如果要使用延迟渲染的话，显卡必须支持 MRT（Multiple Render Targets）、Shader Mode 3.0 及以上、深度渲染纹理以及双面的模板缓冲。</li>\n</ul>\n<blockquote>\n<p>通常我们使用前向渲染路径类型：)</p>\n</blockquote>\n<h2 id=\"unity光源类型\"><a class=\"markdownIt-Anchor\" href=\"#unity光源类型\">#</a> Unity 光源类型</h2>\n<h2 id=\"阴影\"><a class=\"markdownIt-Anchor\" href=\"#阴影\">#</a> 阴影</h2>\n<h3 id=\"不透明物体的阴影\"><a class=\"markdownIt-Anchor\" href=\"#不透明物体的阴影\">#</a> 不透明物体的阴影</h3>\n<p><img data-src=\"http://pic.fasty97.top/NotePad/202209131137666.png\" alt=\"image-20220913113734111\"></p>\n<center>通过MeshRender可以设置阴影</center>\n<p>将 CastShaows 设置为 <code>Two Sided</code>  可以双面渲染。</p>\n<blockquote>\n<p>Unity 选择使用一个额外的 Pass 来专门更新光源的阴影映射纹理，这个 Pass 就是 <code>LightMode</code>  标签被设置为 <code>ShadowCaster</code>  的 <code>Pass</code> 。</p>\n</blockquote>\n<ul>\n<li>接收阴影：对阴影纹理进行采样，最终把阴影纹理和光照进行相乘。</li>\n<li>投射阴影：加入到光源的阴影纹理计算中，通过指定的 Pass 来实现，如果使用了屏幕空间投射，还会生成一张摄像机的深度图。</li>\n</ul>\n<h4 id=\"接收阴影\"><a class=\"markdownIt-Anchor\" href=\"#接收阴影\">#</a> 接收阴影</h4>\n<ol>\n<li>在 BasePass 中包含内置文件：</li>\n</ol>\n<figure class=\"highlight glsl\"><figcaption data-lang=\"GLSL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">\"AutoLight.cginc\"</span></span></pre></td></tr></table></figure><ol start=\"2\">\n<li>在顶点着色器的输出结构体中添加 <code>SHADOW_COORDS</code></li>\n</ol>\n<p>SHADOW_COORDS(2)</p>\n<ol start=\"3\">\n<li>在顶点着色器返回之前添加一个内置宏 <code>TRANSFER_SHADOW</code></li>\n</ol>\n<p>TRANSFER_SHADOW(o)</p>\n<ol start=\"4\">\n<li>在片元着色器中计算阴影值，使用 <code>SHADOW_ATTENUATION</code></li>\n</ol>\n<p>fixed shadow=SHADOW_ATTENUATION(i)</p>\n<blockquote>\n<p>📖PS: 由于这些宏中会使用上下文变量来进行相关计算，例如 TRANSFER_SHADOW 会使用 v.vertex 或 a.pos 来计算坐标，因此为了能够让这些宏正确工作，我们需要保证自定义的变量名和这些宏中使用的变量名相匹配。我们需要保证：a2f 结构体中的顶点坐标变量名必须是 vertex，顶点着色器的输出结构体 v2f 必须命名为 v，且 v2f 中的顶点位置变量必须命名为 pos。</p>\n</blockquote>\n<h3 id=\"透明物体的阴影\"><a class=\"markdownIt-Anchor\" href=\"#透明物体的阴影\">#</a> 透明物体的阴影</h3>\n",
            "tags": [
                "Shader",
                "读书笔记"
            ]
        },
        {
            "id": "https://www.fasty97.top/2021/12/07/Unity%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%EF%BC%88%E4%BA%94%EF%BC%89Shader%E5%85%A5%E9%97%A8/",
            "url": "https://www.fasty97.top/2021/12/07/Unity%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%EF%BC%88%E4%BA%94%EF%BC%89Shader%E5%85%A5%E9%97%A8/",
            "title": "Unity入门精要（五）Shader入门",
            "date_published": "2021-12-07T07:31:05.000Z",
            "content_html": "",
            "tags": [
                "Shader",
                "读书笔记"
            ]
        },
        {
            "id": "https://www.fasty97.top/2021/12/03/Unity%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%EF%BC%88%E5%9B%9B%EF%BC%89%20%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/",
            "url": "https://www.fasty97.top/2021/12/03/Unity%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%EF%BC%88%E5%9B%9B%EF%BC%89%20%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/",
            "title": "Unity入门精要（四） 数学基础",
            "date_published": "2021-12-03T15:18:37.000Z",
            "content_html": "<blockquote>\n<p>最常使用到的就是矢量和矩阵（数学的分支之一 —— 线性代数）</p>\n</blockquote>\n<h1 id=\"笛卡尔坐标系\"><a class=\"markdownIt-Anchor\" href=\"#笛卡尔坐标系\">#</a> 笛卡尔坐标系</h1>\n<blockquote>\n<p>大部分的计算位置、距离和角度等变量都是在笛卡尔坐标系下进行的。</p>\n</blockquote>\n<h2 id=\"二维笛卡尔坐标系\"><a class=\"markdownIt-Anchor\" href=\"#二维笛卡尔坐标系\">#</a> 二维笛卡尔坐标系</h2>\n<ul>\n<li>一个特殊的位置，原点，它是整个坐标系的中心</li>\n<li>两条过原点相互垂直的矢量，x 轴和 y 轴。</li>\n</ul>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211203134502.png\" alt=\"image-20211203134455788\"></p>\n<blockquote>\n<p>不同的渲染方式，坐标系不同</p>\n</blockquote>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211203134650.png\" alt=\"image-20211203134650147\"></p>\n<h2 id=\"三维笛卡尔坐标系\"><a class=\"markdownIt-Anchor\" href=\"#三维笛卡尔坐标系\">#</a> 三维笛卡尔坐标系</h2>\n<ul>\n<li>三个坐标轴相互垂直，长度为 1，这样的基矢量被称为标准正交基</li>\n<li>这三个坐标轴被称为是基矢量</li>\n</ul>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211203134755.png\" alt=\"image-20211203134755628\"></p>\n<h2 id=\"左手坐标系和右手坐标系\"><a class=\"markdownIt-Anchor\" href=\"#左手坐标系和右手坐标系\">#</a> 左手坐标系和右手坐标系</h2>\n<blockquote>\n<p>在二维笛卡尔坐标系中，我们可以通过旋转将任何的坐标系重合，也就是说所有的二维笛卡尔坐标系都是等价的。</p>\n<p>但对于 <code>三维坐标系</code> ，有时不能靠这种旋转来使 2 个不同朝向的坐标系重合。</p>\n</blockquote>\n<h3 id=\"左手坐标系\"><a class=\"markdownIt-Anchor\" href=\"#左手坐标系\">#</a> 左手坐标系</h3>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211203135648.png\" alt=\"image-20211203135647988\"></p>\n<h3 id=\"右手坐标系\"><a class=\"markdownIt-Anchor\" href=\"#右手坐标系\">#</a> 右手坐标系</h3>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211203135727.png\" alt=\"image-20211203135727456\"></p>\n<h2 id=\"unity的坐标系\"><a class=\"markdownIt-Anchor\" href=\"#unity的坐标系\">#</a> Unity 的坐标系</h2>\n<ul>\n<li>在模型空间和世界空间中，使用左手坐标系</li>\n<li>观察空间，使用右手坐标系，z 轴坐标的减少意味着场景深度的增加</li>\n</ul>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211203140041.png\" alt=\"image-20211203140041620\"></p>\n<h2 id=\"练习\"><a class=\"markdownIt-Anchor\" href=\"#练习\">#</a> 练习</h2>\n<ol>\n<li>右手坐标系</li>\n<li></li>\n</ol>\n<h1 id=\"点和矢量\"><a class=\"markdownIt-Anchor\" href=\"#点和矢量\">#</a> 点和矢量</h1>\n<h1 id=\"矩阵\"><a class=\"markdownIt-Anchor\" href=\"#矩阵\">#</a> 矩阵</h1>\n<h1 id=\"矩阵变换\"><a class=\"markdownIt-Anchor\" href=\"#矩阵变换\">#</a> 矩阵变换</h1>\n<h1 id=\"坐标空间\"><a class=\"markdownIt-Anchor\" href=\"#坐标空间\">#</a> 坐标空间</h1>\n<h1 id=\"法线变换\"><a class=\"markdownIt-Anchor\" href=\"#法线变换\">#</a> 法线变换</h1>\n",
            "tags": [
                "Shader",
                "读书笔记"
            ]
        },
        {
            "id": "https://www.fasty97.top/2021/11/30/Shader%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%EF%BC%88%E4%B8%89%EF%BC%89UnityShader/",
            "url": "https://www.fasty97.top/2021/11/30/Shader%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%EF%BC%88%E4%B8%89%EF%BC%89UnityShader/",
            "title": "Shader入门精要（三）UnityShader",
            "date_published": "2021-11-30T14:30:18.000Z",
            "content_html": "<h1 id=\"第三章-unityshader基础\"><a class=\"markdownIt-Anchor\" href=\"#第三章-unityshader基础\">#</a> 第三章 UnityShader 基础</h1>\n<blockquote>\n<p>正式进入 shader 学习了，好耶！</p>\n</blockquote>\n<p>使用 UnityShader 的流程：</p>\n<ol>\n<li>创建一个材质</li>\n<li>创建一个 UnityShader，为材质添加</li>\n<li>把材质赋给对象</li>\n<li>调整 shader 属性</li>\n</ol>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211130223524.png\" alt=\"image-20211130223524763\"></p>\n<h2 id=\"创建shader\"><a class=\"markdownIt-Anchor\" href=\"#创建shader\">#</a> 创建 Shader</h2>\n<p>Unity 包含了多种 shader 模板供我们使用。</p>\n<table>\n<thead>\n<tr>\n<th>Standard Surface Shader</th>\n<th>标准光照模型</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Unlit Shader</td>\n<td>不包含光照（但包含雾效）</td>\n</tr>\n<tr>\n<td>mage Effect Shader</td>\n<td>实现各种屏幕后处理效果</td>\n</tr>\n<tr>\n<td></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<p>Unity Shader 的导入面板还可以方便地查看其使用的渲染队列（Render queue）、是否关闭批处理（Disablebatching）、属性列表（Properties）等信息。</p>\n<h2 id=\"shaderlab\"><a class=\"markdownIt-Anchor\" href=\"#shaderlab\">#</a> ShaderLab</h2>\n<p>ShaderLab 是 Unity 为我们抽象的一种 shader 语言，可以更方便的通用。</p>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211130224529.png\" alt=\"image-20211130224529408\"></p>\n<h3 id=\"基本结构\"><a class=\"markdownIt-Anchor\" href=\"#基本结构\">#</a> 基本结构</h3>\n<figure class=\"highlight glsl\"><figcaption data-lang=\"GLSL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Shader <span class=\"token string\">\"ShaderName\"</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>\tProperties<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>\t\t<span class=\"token comment\">// 属性</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>        <span class=\"token function\">Name</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"display name\"</span><span class=\"token punctuation\">,</span> PropertyType<span class=\"token punctuation\">)</span><span class=\"token operator\">=</span>DefaultValue</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>\tSubShader<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>\t\t<span class=\"token comment\">//A 着色器</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\tSubShader<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>\t\t<span class=\"token comment\">//B 着色器</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t\t</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>\t<span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>\tFallback <span class=\"token string\">\"VertexLit\"</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"属性类型\"><a class=\"markdownIt-Anchor\" href=\"#属性类型\">#</a> 属性类型</h3>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211130225328.png\" alt=\"image-20211130225328452\"></p>\n<p>根据以上属性得到的 Shader 放置在材质上效果：</p>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211201122201.png\" alt=\"image-20211201122154053\"></p>\n<h3 id=\"subshader\"><a class=\"markdownIt-Anchor\" href=\"#subshader\">#</a> SubShader</h3>\n<blockquote>\n<p>每个 Unityshader 可以包含多个 SubShader， <code>最少要有一个</code> 。</p>\n</blockquote>\n<p>加载时会自动选择第一个可以执行的 SubShader，如果都不支持的话，使用 FallBack 指定的 shader。（为了解决不同显卡的差异）</p>\n<figure class=\"highlight glsl\"><figcaption data-lang=\"GLSL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>SubShader<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token comment\">// 可选的</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token punctuation\">[</span>Tages<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\">// 可选的</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">[</span>RenderSetup<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    Pass <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token comment\">//other Passes</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>每个 Pass 定义了一次完整的渲染流程，Pass 过多，性能下降。</p>\n<h4 id=\"状态设置\"><a class=\"markdownIt-Anchor\" href=\"#状态设置\">#</a> 状态设置</h4>\n<p>在 SubShader 中我们可以设置渲染的一些状态。</p>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211201123019.png\" alt=\"image-20211201123019333\"></p>\n<p>在 SubShader 中设置的状态会应用到所有的 Pass，也可以在 Pass 中单独设置。</p>\n<figure class=\"highlight glsl\"><figcaption data-lang=\"GLSL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Tags<span class=\"token punctuation\">&#123;</span><span class=\"token string\">\"TagName1\"</span><span class=\"token operator\">=</span><span class=\"token string\">\"Value1\"</span> <span class=\"token string\">\"TagName2\"</span><span class=\"token operator\">=</span><span class=\"token string\">\"CC\"</span><span class=\"token punctuation\">&#125;</span> <span class=\"token comment\">//Tags 是一些 str 键值对</span></pre></td></tr></table></figure><h4 id=\"subshader标签类型\"><a class=\"markdownIt-Anchor\" href=\"#subshader标签类型\">#</a> SubShader 标签类型</h4>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211201123359.png\" alt=\"image-20211201123359479\"></p>\n<blockquote>\n<p>这些标签只能在 SubShader 中申明不可在 Pass 中申明</p>\n</blockquote>\n<h3 id=\"pass\"><a class=\"markdownIt-Anchor\" href=\"#pass\">#</a> Pass</h3>\n<figure class=\"highlight glsl\"><figcaption data-lang=\"GLSL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Pass<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    <span class=\"token punctuation\">[</span>Name<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token punctuation\">[</span>Tags<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token punctuation\">[</span>RenderSetup<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token comment\">//Other</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>可以通过 Name 来使用 Pass，例如：</p>\n<p><code>UsePass &quot;MyShader/PASSNAME&quot;</code></p>\n<blockquote>\n<p>默认 Unity 会将所有 Pass 名称转换为大写，所以使用时需要使用大写名称</p>\n</blockquote>\n<h4 id=\"pass标签类型\"><a class=\"markdownIt-Anchor\" href=\"#pass标签类型\">#</a> Pass 标签类型</h4>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211201124000.png\" alt=\"image-20211201124000121\"></p>\n<ul>\n<li>\n<p>・UsePass：如我们之前提到的一样，可以使用该命令来复用其他 Unity Shader 中的 Pass；</p>\n</li>\n<li>\n<p>・GrabPass：该 Pass 负责抓取屏幕并将结果存储在一张纹理中，以用于后续的 Pass 处理（详见 10.2.2 节）。</p>\n</li>\n</ul>\n<h3 id=\"fallback\"><a class=\"markdownIt-Anchor\" href=\"#fallback\">#</a> FallBack</h3>\n<p>在 SubShader 后定义，如果上述的都不支持，用这个最低级的 Shader 吧！</p>\n<figure class=\"highlight glsl\"><figcaption data-lang=\"GLSL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Fallback <span class=\"token string\">\"name\"</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">// 或者</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Fallback off</pre></td></tr></table></figure><blockquote>\n<p>FallBack 还会影响阴影的透射</p>\n</blockquote>\n<h2 id=\"unity-shader形式\"><a class=\"markdownIt-Anchor\" href=\"#unity-shader形式\">#</a> Unity Shader 形式</h2>\n<p>着色器代码可以写在 SubShader 中（表面着色器做法），也可以写在 Pass 语义块中（顶点 / 片元着色器和固定函数着色器的做法）。</p>\n<figure class=\"highlight glsl\"><figcaption data-lang=\"GLSL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Shader <span class=\"token string\">\"MyShader\"</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    Properties<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        <span class=\"token comment\">// 所需的各种属性</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>        </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    SubShader<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>        <span class=\"token comment\">// 真正意义上的 shader 代码会放在这里</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>        <span class=\"token comment\">// 表面着色器（Surface Shader）</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        <span class=\"token comment\">// 顶点 / 片元着色器（Vertex/Fragment Shader)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>        <span class=\"token comment\">// 固定函数着色器（Fixed Function Shader）</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>    SubShader<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token comment\">// 和上一哥 SubShader 类似</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><h3 id=\"表面着色器surface-shader\"><a class=\"markdownIt-Anchor\" href=\"#表面着色器surface-shader\">#</a> 表面着色器 (Surface Shader)</h3>\n<blockquote>\n<p>是 Unity 自己创造的一种着色器代码类型，需要的代码量少，渲染代价比较大</p>\n</blockquote>\n<p>在背后，任然转换为顶点片元着色器。</p>\n<pre><code class=\"language-glSL\">Shader &quot;Custom/Simple&quot;&#123;\n    SubShader&#123;\n        Tags&#123;&quot;RenderType&quot;= &quot;Opaque&quot;&#125;\n        CGPROGRAM\n        #pragma suface surf lambert\n            struct Input&#123;\n                float4 color: COLOR;\n            &#125;\n        void surf(Input In,in out SurfaceOutput o)&#123;\n            o.Albedo=1;\n        &#125;\n        ENDCG\n    &#125;\n    Fallback &quot;Diffuse&quot;\n&#125;\n</code></pre>\n<p>表面着色器不需要关心，有多少个 Pass，每个 Pass 如何渲染</p>\n<p>CGPROGRAM 和 ENDCG 之间的代码是使用 CG/HLSL 编写的，也就是说，我们需要把 CG/HLSL 语言嵌套在 ShaderLab 语言中。</p>\n<h3 id=\"顶点片元着色器vertexfragment-shader\"><a class=\"markdownIt-Anchor\" href=\"#顶点片元着色器vertexfragment-shader\">#</a> 顶点片元着色器（Vertex/Fragment Shader）</h3>\n<figure class=\"highlight glsl\"><figcaption data-lang=\"GLSL\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>Shader <span class=\"token string\">\"Custom/Simple VertexFragment Shader\"</span><span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>    SubShader<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>        Pass<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>            CGPROGRAM</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>            <span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">vertex vert</span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>            <span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">pragma</span> <span class=\"token expression\">fragment frag float4 <span class=\"token function\">vert</span><span class=\"token punctuation\">(</span>float4 v<span class=\"token operator\">:</span> POSITION<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>SV_POSITION<span class=\"token punctuation\">&#123;</span></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>                    <span class=\"token keyword\">return</span> <span class=\"token function\">mul</span><span class=\"token punctuation\">(</span>UNITY_MATRIX_MVP<span class=\"token punctuation\">,</span>v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>                <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>            fixed4 <span class=\"token function\">frag</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span>SV_Target<span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>                <span class=\"token keyword\">return</span> <span class=\"token function\">fixed4</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>            <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>            ENDCG</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>        <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>顶点 / 片元着色器的代码也需要定义在 CGPROGRAM 和 ENDCG 之间，但不同的是，顶点 / 片元着色器是写在 Pass 语义块内，而非 SubShader 内的.</p>\n<h3 id=\"固定函数着色器\"><a class=\"markdownIt-Anchor\" href=\"#固定函数着色器\">#</a> 固定函数着色器</h3>\n<blockquote>\n<p>对于一些比较老旧的设备，不支持可编程管线着色器，就需要使用固定函数着色器</p>\n</blockquote>\n<h3 id=\"使用哪种形式\"><a class=\"markdownIt-Anchor\" href=\"#使用哪种形式\">#</a> 使用哪种形式？</h3>\n<ul>\n<li>如果你想和各种光源打交道，你可能更喜欢使用表面着色器，但需要小心它在移动平台的性能表现。</li>\n<li>如果你需要使用的光照数目非常少，例如只有一个平行光，那么使用顶点 / 片元着色器是一个更好的选择。</li>\n<li>最重要的是，如果你有很多自定义的渲染效果，那么请选择顶点 / 片元着色器。</li>\n</ul>\n<blockquote>\n<p>至此，第三章完！</p>\n</blockquote>\n",
            "tags": [
                "Shader",
                "读书笔记"
            ]
        },
        {
            "id": "https://www.fasty97.top/2021/09/10/Shader%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%EF%BC%88%E4%BA%8C%EF%BC%89/",
            "url": "https://www.fasty97.top/2021/09/10/Shader%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%EF%BC%88%E4%BA%8C%EF%BC%89/",
            "title": "Shader入门精要（二）",
            "date_published": "2021-09-10T07:00:15.000Z",
            "content_html": "<blockquote>\n<p>因为第一章内容太少，就再更一章吧～</p>\n</blockquote>\n<h1 id=\"第二篇-渲染流水线\"><a class=\"markdownIt-Anchor\" href=\"#第二篇-渲染流水线\">#</a> 第二篇 渲染流水线</h1>\n<p>Q: 渲染流水线在干什么？</p>\n<p>A: 渲染流水线的最终目的在于生成或者说是渲染一张二维纹理，即我们在电脑屏幕上看到的所有效果。它的输入是一个虚拟摄像机、一些光源、一些 Shader 以及纹理等。</p>\n<p>使用流水线的好处在于可以提高单位时间的生产量。</p>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20210911215359.png\" alt=\"image-20210911215352715\"></p>\n<p>流水线系统中决定最后生产速度的是最慢的工序所需的时间 ( <code>短板效应</code> )</p>\n<p>理想情况下，如果把一个非流水线系统分成 n 个流水线阶段，且每个阶段耗费时间相同的话，会使整个系统得到 n 倍的速度提升。（多线渲染？）</p>\n<h2 id=\"渲染流程概念上的流水线\"><a class=\"markdownIt-Anchor\" href=\"#渲染流程概念上的流水线\">#</a> 渲染流程 (概念上的流水线)</h2>\n<blockquote>\n<p>渲染流程分成 3 个阶段：应用阶段（Application Stage）、几何阶段（Geometry Stage）、光栅化阶段（Rasterizer Stage）。</p>\n</blockquote>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20210911215704.png\" alt=\"image-20210911215704318\"></p>\n<h3 id=\"应用阶段\"><a class=\"markdownIt-Anchor\" href=\"#应用阶段\">#</a> 应用阶段</h3>\n<p>这个阶段 <code>是由我们的应用主导</code> 的，因此通常由 <code>CPU负责实现</code> 。主要包含三个任务：</p>\n<pre>Error: Evaluation failed: TypeError: Cannot read property 'initialize' of undefined\n    at __puppeteer_evaluation_script__:3:32</pre><h3 id=\"几何阶段\"><a class=\"markdownIt-Anchor\" href=\"#几何阶段\">#</a> 几何阶段</h3>\n<p>几何阶段用于处理所有和我们要绘制的几何相关的事情。例如，决定需要绘制的图元是什么，怎样绘制它们，在哪里绘制它们。这一阶段 <code>通常在GPU上</code> 进行。几何阶段负责和每个渲染图元打交道，进行逐顶点、逐多边形的操作。这个阶段 <code>可以进一步分成更小的流水线阶段</code> ，这在下一章中会讲到。几何阶段的一个重要任务就是 <code>把顶点坐标变换到屏幕空间中</code> ，再交给光栅器进行处理。通过对输入的渲染图元进行多步处理后，这一阶段将会输出屏幕空间的二维顶点坐标、每个顶点对应的深度值、着色等相关信息，并传递给下一个阶段。</p>\n<h3 id=\"光栅化阶段\"><a class=\"markdownIt-Anchor\" href=\"#光栅化阶段\">#</a> 光栅化阶段</h3>\n<p>这一阶段将会使用上个阶段传递的数据来产生屏幕上的像素，并 <code>渲染出最终的图像</code> 。 <code>这一阶段也是在GPU上运行</code> 。光栅化的任务主要是 <code>决定每个渲染图元中的哪些像素应该被绘制在屏幕上</code> 。它需要对上一个阶段得到的逐顶点数据（例如纹理坐标、顶点颜色等）进行插值，然后再进行逐像素处理。和上一个阶段类似，光栅化阶段也 <code>可以分成更小的流水线阶段</code> 。</p>\n<h2 id=\"cpu与gpu通信\"><a class=\"markdownIt-Anchor\" href=\"#cpu与gpu通信\">#</a> CPU 与 GPU 通信</h2>\n<blockquote>\n<p>真实的流水线🔨</p>\n</blockquote>\n<p>渲染流水线的起点是 CPU，即应用阶段。应用阶段大致可分为下面 3 个阶段：</p>\n<pre>Error: Evaluation failed: TypeError: Cannot read property 'initialize' of undefined\n    at __puppeteer_evaluation_script__:3:32</pre><h3 id=\"把数据加载到显存中\"><a class=\"markdownIt-Anchor\" href=\"#把数据加载到显存中\">#</a> 把数据加载到显存中</h3>\n<p>数据需要从硬盘到内存再到显存，显存读取速度快！加载之后就会丢弃，为了运算，某些数据不应该被丢弃，</p>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20210911221304.png\" alt=\"image-20210911221304571\"></p>\n<p>因为从硬盘加载到 RAM 的过程是十分耗时的，故我们要编写程序指导 CPU ，不要丢弃。</p>\n<blockquote>\n<p>9.14 继续更新啦😃</p>\n</blockquote>\n<h3 id=\"设置渲染状态\"><a class=\"markdownIt-Anchor\" href=\"#设置渲染状态\">#</a> 设置渲染状态</h3>\n<blockquote>\n<p>这些状态定义了场景中的网格是怎样被渲染的</p>\n</blockquote>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20210914131155.png\" alt=\"image-20210914131148894\"></p>\n<center>在同一状态下渲染3个网格。由于没有更改渲染状态，因此3个网格的外观看起来像是同一种材质的物体</center>\n<h3 id=\"调用draw-call\"><a class=\"markdownIt-Anchor\" href=\"#调用draw-call\">#</a> 调用 Draw Call</h3>\n<p>在设置好渲染状态后，就开始绘制了。 <code>由CPU发起，GPU接收</code> 。</p>\n<blockquote>\n<p>11.30 继续更新 😺</p>\n</blockquote>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211130192907.png\" alt=\"image-20211130192900305\"></p>\n<h2 id=\"gpu流水线\"><a class=\"markdownIt-Anchor\" href=\"#gpu流水线\">#</a> GPU 流水线</h2>\n<blockquote>\n<p>当 GPU 收到渲染命令后，进行一系列流水线操作，将图元渲染到屏幕上</p>\n</blockquote>\n<p>GPU 主要实现 几何阶段和光栅化阶段。</p>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211130193451.png\" alt=\"image-20211130193451213\"></p>\n<p>其中说明如下：</p>\n<ul>\n<li>完全可编程控制： 顶点着色器、曲面细分着色器、几何着色器、片元着色器</li>\n<li>可配置不可编程：逐片元、裁剪、</li>\n<li>不可控制：屏幕映射、三角形设置、三角形遍历</li>\n<li><code>实现为必须由开发者实现，虚线为可选</code></li>\n</ul>\n<h3 id=\"顶点着色器\"><a class=\"markdownIt-Anchor\" href=\"#顶点着色器\">#</a> 顶点着色器</h3>\n<p>完全可编程</p>\n<blockquote>\n<p>用于实现顶点的空间变换、顶点着色</p>\n</blockquote>\n<ol>\n<li>输入来自于 CPU</li>\n<li>处理单位为顶点</li>\n<li>不可以创建或销毁顶点、无法得到顶点之间的关系</li>\n<li>处理速度很快</li>\n<li>进行坐标变换和顶点光照</li>\n<li>还可以输出后续所需要的一些数据</li>\n</ol>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211130214131.png\" alt=\"image-20211130214131052\"></p>\n<p>核心任务：** 顶点坐标从 <code>模型空间</code> 转换到 <code>齐次裁剪空间</code></p>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211130214642.png\" alt=\"image-20211130214642514\"></p>\n<p>转换到齐次裁减空间后，硬件通过做透视触发得到 <code>NDC（设备坐标）</code> 下的坐标。</p>\n<blockquote>\n<p>NDC OpenGL (Unity) 范围在【-1,1】</p>\n</blockquote>\n<h3 id=\"曲面细分着色器\"><a class=\"markdownIt-Anchor\" href=\"#曲面细分着色器\">#</a> 曲面细分着色器</h3>\n<p>是一个可选的着色器，它用于细分图元</p>\n<h3 id=\"几何着色器\"><a class=\"markdownIt-Anchor\" href=\"#几何着色器\">#</a> 几何着色器</h3>\n<p>是一个可选的着色器，它可以被用于执行逐图元（Per-Primitive）的着色操作，或者被用于产生更多的图元</p>\n<h3 id=\"裁剪\"><a class=\"markdownIt-Anchor\" href=\"#裁剪\">#</a> 裁剪</h3>\n<p><strong>可配置但不可编程。</strong></p>\n<blockquote>\n<p>这一阶段的目的是将那些不在摄像机视野内的顶点裁剪掉，并剔除某些三角图元的面片</p>\n</blockquote>\n<p><code>用于完成裁剪掉只有部分在摄像机范围内出现的物体。</code></p>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211130215204.png\" alt=\"image-20211130215204031\"></p>\n<p>经过裁剪，会在相交处生成新的点，同时原先的旧的点（在范围外）将被删除掉。</p>\n<h3 id=\"屏幕映射\"><a class=\"markdownIt-Anchor\" href=\"#屏幕映射\">#</a> 屏幕映射</h3>\n<p>输入三维坐标，二维屏幕坐标</p>\n<blockquote>\n<p>任务：把每个图元的 X 和 y 坐标转换到屏幕坐标系</p>\n</blockquote>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211130215609.png\" alt=\"image-20211130215609144\"></p>\n<p>在 OpenGL 中，原点位于左下角，在 DirectX 中，原点在左上角</p>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211130215806.png\" alt=\"image-20211130215806421\"></p>\n<h3 id=\"三角形遍历\"><a class=\"markdownIt-Anchor\" href=\"#三角形遍历\">#</a> 三角形遍历</h3>\n<blockquote>\n<p>检查每个像素是否被一个三角网格所覆盖。如果被覆盖就生成一个 ` 片元，输出片元序列。</p>\n</blockquote>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211130220052.png\" alt=\"image-20211130220052140\"></p>\n<h3 id=\"片元着色器\"><a class=\"markdownIt-Anchor\" href=\"#片元着色器\">#</a> 片元着色器</h3>\n<p>计算出颜色</p>\n<blockquote>\n<p>经过前面的三角形步骤，获得了一系列的数据信息，用来表述一个三角形网格式怎样覆盖到每个像素的。</p>\n<p>输入为：顶点插值数据</p>\n<p>输出为：一个或多个颜色</p>\n</blockquote>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211130220450.png\" alt=\"image-20211130220450027\"></p>\n<h3 id=\"逐片元\"><a class=\"markdownIt-Anchor\" href=\"#逐片元\">#</a> 逐片元</h3>\n<p>渲染流水线的最后一步❤️</p>\n<blockquote>\n<p>逐片元操作（Per-FragmentOperations）阶段负责执行很多重要的操作，例如 <code>修改颜色</code> 、 <code>深度缓冲</code> 、 <code>进行混合等</code></p>\n<p>用于合并数据。</p>\n</blockquote>\n<p>这一个阶段有如下任务：</p>\n<ol>\n<li>决定每个片元的可见性。这涉及了很多测试工作，例如深度测试、模板测试等。</li>\n<li>如果一个片元通过了所有的测试，就需要把这个片元的颜色值和已经存储在颜色缓冲区中的颜色进行合并，或者说是混合。</li>\n</ol>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211130220813.png\" alt=\"image-20211130220813558\"></p>\n<p>需要通过所有的测试，才能和颜色缓冲区混合，最后写入颜色缓冲区</p>\n<blockquote>\n<p>这些测试用于筛选掉一些无用片元</p>\n</blockquote>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211130221004.png\" alt=\"image-20211130221004246\"></p>\n<p>当片元通过了所有测试，就会进入混合阶段</p>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20211130221310.png\" alt=\"image-20211130221310360\"></p>\n<p>对于透明效果需要开启混合，对于不透明物体可以选择关闭混合效果</p>\n<blockquote>\n<p>出于性能考虑，很多 GPU 会先进行测试在进行片元着色器 —— Early-Z 技术</p>\n</blockquote>\n<p>为了避免我们看到正在光栅化的图元，GPU 使用 <code>双重缓冲</code> ，我们看到的是前置渲染结构，同时后置渲染也在工作，但后置渲染完成就会交换前后渲染的内容。</p>\n<h1 id=\"什么是shader\"><a class=\"markdownIt-Anchor\" href=\"#什么是shader\">#</a> 什么是 Shader?</h1>\n<ul>\n<li>GPU 流水线上一些可高度编程的阶段，而由着色器编译出来的最终代码是会在 GPU 上运行的（对于固定管线的渲染来说，着色器有时等同于一些特定的渲染设置）</li>\n<li>有一些特定类型的着色器，如顶点着色器、片元着色器等；</li>\n</ul>\n<blockquote>\n<p>第二章完！</p>\n</blockquote>\n",
            "tags": [
                "Shader",
                "读书笔记"
            ]
        },
        {
            "id": "https://www.fasty97.top/2021/09/10/Shader%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%EF%BC%88%E4%B8%80%EF%BC%89/",
            "url": "https://www.fasty97.top/2021/09/10/Shader%E5%85%A5%E9%97%A8%E7%B2%BE%E8%A6%81%EF%BC%88%E4%B8%80%EF%BC%89/",
            "title": "Shader入门精要（一）",
            "date_published": "2021-09-10T06:57:37.000Z",
            "content_html": "<h2 id=\"致自己\"><a class=\"markdownIt-Anchor\" href=\"#致自己\">#</a> 致自己</h2>\n<blockquote>\n<p>之前我学习过一段时间的 Shader 入门精要（大概是学到第六章吧），但后面的章节都没有学习，加上时间久远很多内容都忘记了，故打算重新学一遍。</p>\n<p>为了勉励自己坚持下去，也为了记录一些学习过程，此系列就出现啦！</p>\n<p>❤️ ❤️</p>\n<p>(希望自己能够坚持学完，在渲染方面有所收获，可以制作出满意的效果)</p>\n<p>📑 此系列每周一更</p>\n</blockquote>\n<p><img data-src=\"https://pic.fasty97.top/NotePad/20210910151044.png\" alt=\"image-20210910151043222\"></p>\n<h1 id=\"第一篇-欢迎来到shader的世界\"><a class=\"markdownIt-Anchor\" href=\"#第一篇-欢迎来到shader的世界\">#</a> 第一篇 欢迎来到 Shader 的世界</h1>\n<h2 id=\"语录\"><a class=\"markdownIt-Anchor\" href=\"#语录\">#</a> 语录</h2>\n<ul>\n<li>\n<p>程序员的三大浪漫是编译原理、操作系统和图形学（是的，我已经听到很多人在反驳这句话了，不要当真啦）</p>\n</li>\n<li>\n<p>我们是程序员中的 “外貌协会”，期待着用代码编写出一个绚丽多姿的世界。这就是我们的浪漫。</p>\n</li>\n<li>\n<p>我们之所以要学习 Shader，是想要学习如何把物体按照自己的意愿渲染到屏幕上，但是，Shader 只是整个渲染流程中的一个子部分。</p>\n</li>\n<li>\n<p>和 C++ 这样的高级语言不同，尽管 Shader 的编写语言已经达到了我们可以理解的程度，但 Shader 更多地是面向 GPU 的工作方式，所以它的一些语法对我们来说并不那么直观。</p>\n</li>\n</ul>\n<h2 id=\"基础篇大纲1-4章\"><a class=\"markdownIt-Anchor\" href=\"#基础篇大纲1-4章\">#</a> 基础篇大纲 1-4 章</h2>\n<ol>\n<li><code>第2章 渲染流水线</code>  这一章讲解了现代 GPU 是如何实现整个渲染流水线的，这些内容对于理解 Shader 的工作原理有着非常重要的作用。</li>\n<li><code>第3章Unity Shader基础</code>  Unity 在原有的渲染流程上进行了封装，并提供给开发者新的图像编程接口 ——Unity Shader。这一章将讲解 Unity Shader 的实现原理和基本语法</li>\n<li><code>第4章 学习Shader所需的数学基础</code>  数学向来是初学者面对的一大学习障碍。然而，在初级阶段的渲染学习中，我们需要掌握的数学理论实际并不复杂。本章将为读者讲解渲染过程中常见的数学知识，如矢量、矩阵运算、坐标空间等。</li>\n</ol>\n<h2 id=\"自我理解\"><a class=\"markdownIt-Anchor\" href=\"#自我理解\">#</a> 自我理解</h2>\n<p>本章主要讲述了本书的结构的内容大纲，引出了 shader 学习的问题。</p>\n<p>尽管是第二次读，依然觉得有趣～</p>\n",
            "tags": [
                "Shader",
                "读书笔记"
            ]
        }
    ]
}